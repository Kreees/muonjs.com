m.packageInitData['tutorial'] = {
"package": (function(global){ var module = {}; module.exports = {
    "useAppLayout": true,
    pages: ["*"],
    ready: function(cb){
        cb();
    },
    routes: [
        {
            route: "",
            redirect: "general"
        },
        {
            route: ":type",
            callback: "index",
            page: 'index'
        },
        {
            page: "chapter",
            route: ":type/:id(/:sub)",
            callback: "chapter"
        }
    ],
    surrogate: {
        "index": function(type){
            if (this.indexType == type) return;
            this.indexType = type;
            this.m.setProjection("tutorial_section",{type: type});
        },
        "chapter": function(type,id,sub){
            var _this = this;
            this.index(type);
            if (this.chapterType != id){
                this.chapterType  = id;
                this.m.setProjection("tutorial_chapter",{
                    type: id.replace(/-/g,'_')+"_"+type
                });
            }
        }
    }
};; return module.exports; })(window),

"models": {"social_session":"m.Model.extend({\"plugin\":\"\",\"modelName\":\"social_session\",\"urlRoot\":\"https://0.0.0.0:8000/apis/social_session\",\"defaults\":{},\"scheme\":{\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}},{scheme: {\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}});","social_user":"m.Model.extend({\"plugin\":\"\",\"modelName\":\"social_user\",\"urlRoot\":\"https://0.0.0.0:8000/apis/social_user\",\"defaults\":{},\"scheme\":{\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}},{scheme: {\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}});","MUON:project.project":"m.Model.extend({\"plugin\":\"MUON\",\"modelName\":\"MUON:project.project\",\"urlRoot\":\"https://0.0.0.0:8000/apis/MUON:project.project\",\"defaults\":{},\"scheme\":{\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}},{scheme: {\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}});","MUON:user.session":"m.Model.extend({\"plugin\":\"MUON\",\"modelName\":\"MUON:user.session\",\"urlRoot\":\"https://0.0.0.0:8000/apis/MUON:user.session\",\"defaults\":{},\"scheme\":{\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}},{scheme: {\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}});","MUON:user.user":"m.Model.extend({\"plugin\":\"MUON\",\"modelName\":\"MUON:user.user\",\"urlRoot\":\"https://0.0.0.0:8000/apis/MUON:user.user\",\"defaults\":{},\"scheme\":{\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}},{scheme: {\"attributes\":{\"created_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"modified_at\":{\"type\":\"date\",\"time\":true,\"klass\":\"primary\"},\"_id\":{\"type\":\"serial\",\"rational\":\"false\",\"key\":true,\"klass\":\"key\"}},\"hasManyRelations\":{},\"hasOneRelations\":{}}});"},

"views": ["<script type='text/javascript' data-pack='tutorial' id='start_page_layout'>m.PageLayoutView.extend({\n\t    template:'start_page'\n\t  });</script>","<!-- tutorial:widget/chapter/chapter --><style data-pack='tutorial'>body.muon [data-pack='tutorial'][data-muon$='chapter_widget'] {\n  position: relative;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.tutor-img.shadow {\n  padding: 20px;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.tutor-img.shadow img {\n  box-shadow: gray 0 0 20px;\n  border: #bbb solid 1px;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.tutor-img img {\n  width: 100%;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] p {\n  margin: 0 0 0 5px;\n  padding: 10px 15px;\n  text-align: justify;\n  transition: background 500ms;\n  -o-transition: background 500ms;\n  -moz-transition: background 500ms;\n  -webkit-transition: background 500ms;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] p:hover {\n  background-color: #f3f3f3;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark {\n  background-color: #cef;\n  border-left: 5px solid #458;\n  color: darkblue;\n  padding: 3px 0px;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark * {\n  color: #458;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark h1,\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark h2,\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark h3,\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark h4,\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark h5,\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark h6 {\n  padding-left: 25px;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark p {\n  font-size: 13px;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark p:hover {\n  background: none;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] div.mark a {\n  color: #222b44;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] a[target] {\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAAKCAYAAACNMs+9AAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAABx0RVh0U29mdHdhcmUAQWRvYmUgRmlyZXdvcmtzIENTM5jWRgMAAAAUdEVYdENyZWF0aW9uIFRpbWUANi8zLzEwC6nc4QAAAGdJREFUGJWFj7sRgDAMQ5+5rECGgZaUZNi0qVkGhjBNDvIjqPNZ0rNFVenJu/VdiDB1XUCIhzyDKrJvS11pQzyuohEwTbrGggDaoHNTViDDG71b5wLdeyKZTsAC12djLZOl/40JMdQNLzYixzCOBQoAAAAASUVORK5CYII=);\n  background-repeat: no-repeat;\n  background-position: 100% 25%;\n  background-size: 7px 7px;\n  padding-right: 9px;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] a[data-hover] {\n  font-weight: bold;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] a[data-hover]:hover {\n  text-decoration: none;\n  cursor: pointer;\n  color: #800;\n}\nbody.muon [data-pack='tutorial'][data-muon$='chapter_widget'] pre {\n  padding: 10px 20px;\n}\n</style>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='undefined_widget_template'><div></div></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='application_stack_template'><div class=\"row\"><div class=\"col-md-12\"><ul class=\"nav nav-pills pull-right\"><li><a data-route=\"/general\">Общая часть</a></li><li><a data-route=\"/client\">Клиент</a></li><li><a data-route=\"/server\">Сервер</a></li><li><a data-route=\"/mobile\">Mobile</a></li><li><a data-route=\"/practice\">Практика</a></li></ul></div></div><div class=\"row\"><div id=\"target\" class=\"col-md-8 col-sm-8 col-xs-8\"></div><div data-widget-view=\"index\" data-projection=\"tutorial_section\" class=\"col-md-4 col-sm-4 col-xs-4\"></div></div></script>","<script type='text/javascript' data-pack='tutorial' id='chapter_widget'>(function() {\n  window.chapters = [];\n\n  window.ChapterWidgetView = m.WidgetView.extend({\n\t    template:'chapter',\n\t    rendered: function() {\n      var animation_flag, currentRoute, self, tutorialChapter, tutorialSection;\n      currentRoute = \"-1\";\n      tutorialSection = this.m.getProjection(\"tutorial_section\").type;\n      tutorialChapter = this.m.getProjection(\"tutorial_chapter\").type.replace(\"_\" + tutorialSection, \"\");\n      animation_flag = false;\n      self = this;\n      this.routeHandler = (function(_this) {\n        return function(a, b) {\n          var elTo, targetTop;\n          if (tutorialChapter !== b[1] || tutorialSection !== b[0]) {\n            return;\n          }\n          elTo = _this.$(\".title#\" + b[2]);\n          animation_flag = true;\n          self.m.setProjection(\"chapter_link\", \"/\" + b.join(\"/\"));\n          targetTop = 0;\n          if (elTo[0]) {\n            targetTop = elTo.offset().top - 70;\n          }\n          return $(\"body, html\").animate({\n            \"scrollTop\": targetTop\n          }, 1000, \"swing\", function() {\n            animation_flag = false;\n            return self.m.setProjection(\"chapter_link\", \"/\" + b.join(\"/\"));\n          });\n        };\n      })(this);\n      m.router.on(\"route\", this.routeHandler);\n      this.scrollHandler = _.throttle((function(_this) {\n        return function() {\n          var el, element, element_top, lowest, new_route;\n          if (animation_flag) {\n            return;\n          }\n          lowest = 1000000;\n          element = _this.el;\n          element_top = 0;\n          _this.$(\"h5.title, h4.title, h3.title\").each(function() {\n            var top, _top;\n            _top = $(this).offset().top - $(window).scrollTop();\n            top = Math.abs(_top);\n            if (lowest > top) {\n              element_top = _top;\n              lowest = top;\n              return element = this;\n            }\n          });\n          if (element_top > 250) {\n            el = $(element).prevAll(\"h5.title, h4.title, h3.title\")[0];\n            if (el) {\n              element = el;\n              element_top = $(el).offset().top - $(window).scrollTop();\n              lowest = Math.abs(element_top - 100);\n            }\n          }\n          if (currentRoute === element.id) {\n            return;\n          }\n          currentRoute = element.id;\n          new_route = \"/\" + tutorialSection + \"/\" + tutorialChapter + \"/\" + element.id;\n          new_route = new_route.replace(/\\/$/, \"\");\n          m.router.navigate(\"/tutor\" + new_route, {\n            trigger: false\n          });\n          return _this.m.setProjection(\"chapter_link\", new_route);\n        };\n      })(this), 300);\n      setTimeout(_.partial(this.routeHandler, null, m.router.path().replace(/^\\/tutor\\//, \"\").split(\"/\")), 200);\n      window.addEventListener(\"scroll\", this.scrollHandler, false);\n      return _.defer(prettyPrint);\n    },\n    beforeRemove: function() {\n      window.removeEventListener(\"scroll\", this.scrollHandler);\n      return m.router.off(\"route\", this.routeHandler);\n    },\n    beforeReload: function() {\n      window.removeEventListener(\"scroll\", this.scrollHandler);\n      return m.router.off(\"route\", this.routeHandler);\n    },\n    events: {\n      \"mouseover *[data-hover]\": function(e) {\n        return $(e.currentTarget.getAttribute(\"data-hover\")).css({\n          \"background-image\": \"none\",\n          \"background-color\": \"rgba(128,255,128,.3)\",\n          \"box-shadow\": \"rgba(128,255,128,.3) 0 0 20px\"\n        });\n      },\n      \"mouseout *[data-hover]\": function(e) {\n        return $(e.currentTarget.getAttribute(\"data-hover\")).css({\n          \"background-image\": \"\",\n          \"background-color\": \"\",\n          \"box-shadow\": \"\"\n        });\n      }\n    }\n  });\n\n}).call(this);\n</script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='chapter_widget_template'><div data-widget-view=\"<%= this.type %>_chapter\"></div></script>","<script type='text/javascript' data-pack='tutorial' id='application_stack'>(function() {\n  m.ApplicationStackView.extend({\n\t    template:'application',\n\t    target: \"target\",\n    rendered: function() {\n      this.routeHandler = (function(_this) {\n        return function(a, b, c) {\n          return _this.$(\"[data-route='/\" + b[0] + \"']\").parent().addClass(\"active\").siblings().removeClass(\"active\");\n        };\n      })(this);\n      return m.router.on(\"route\", this.routeHandler);\n    },\n    beforeRemove: function() {\n      return m.router.off(\"route\", this.routeHandler);\n    }\n  });\n\n}).call(this);\n</script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='summary_widget_template'><div data-widget-view=\"<%= this.type %>_summary\" class=\"row\"></div></script>","<!-- tutorial:widget/index/index --><style data-pack='tutorial'>body.muon [data-pack='tutorial'][data-muon$='index_widget'] {\n  position: relative;\n}\nbody.muon [data-pack='tutorial'][data-muon$='index_widget'] li {\n  display: block;\n  list-style-type: none;\n  padding: 3px 0 3px 5px;\n}\nbody.muon [data-pack='tutorial'][data-muon$='index_widget'] li:before {\n  position: absolute;\n  left: 1em;\n  color: #428bca;\n}\nbody.muon [data-pack='tutorial'][data-muon$='index_widget'] li.active {\n  background-color: #428bca;\n  color: white;\n}\nbody.muon [data-pack='tutorial'][data-muon$='index_widget'] li.active * {\n  color: white;\n  text-shadow: gray 1px 0 0;\n  text-decoration: none;\n}\nbody.muon [data-pack='tutorial'][data-muon$='index_widget'] ol {\n  counter-reset: list1;\n}\nbody.muon [data-pack='tutorial'][data-muon$='index_widget'] ol li:before {\n  padding-left: 5px;\n  counter-increment: list1;\n  content: counter(list1) \". \";\n}\nbody.muon [data-pack='tutorial'][data-muon$='index_widget'] ol ol {\n  counter-reset: list2;\n  display: none;\n}\nbody.muon [data-pack='tutorial'][data-muon$='index_widget'] ol ol li:before {\n  position: absolute;\n  left: 3em;\n  counter-increment: list2;\n  content: counter(list1) \".\" counter(list2) \". \";\n}\n</style>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='index_widget_template'><br/><h4>Содержание</h4><div data-widget-view=\"<%= this.type %>_index\"></div></script>","<script type='text/javascript' data-pack='tutorial' id='index_widget'>(function() {\n  var speed;\n\n  speed = \"\";\n\n  window.IndexWidget = m.WidgetView.extend({\n\t    template:'index',\n\t    rendered: function() {\n      var fixedFlag, left, ol, positionLeft, positionTop, top, width;\n      top = this.$el.css(\"top\");\n      left = this.$el.css(\"left\");\n      this.updateSelectedTitle = (function(_this) {\n        return function(a, title) {\n          var el, parent;\n          el = _this.$(\"a[data-route='\" + title + \"']\").parent();\n          parent = el.parent();\n          _this.$(\"li\").not(el).removeClass(\"active\");\n          el.addClass(\"active\");\n          if (parent.hasClass(\"subsection\")) {\n            parent.show(speed);\n            return parent.siblings(\"ol\").hide(speed);\n          } else {\n            el.next(\"ol\").show(speed);\n            return el.next(\"ol\").siblings(\"ol\").hide(speed);\n          }\n        };\n      })(this);\n      $(this.m).on(\"projection_updated.chapter_link\", this.updateSelectedTitle);\n      ol = this.$el;\n      positionTop = ol.offset().top;\n      positionLeft = ol.offset().left;\n      width = ol.outerWidth(true);\n      fixedFlag = false;\n      this.scrollHandler = (function(_this) {\n        return function() {\n          if ($(window).scrollTop() > positionTop - 50) {\n            if (fixedFlag) {\n              return;\n            }\n            fixedFlag = true;\n            return ol.css({\n              \"position\": \"fixed\",\n              \"top\": positionTop - 60,\n              \"left\": positionLeft,\n              \"width\": width\n            });\n          } else {\n            if (!fixedFlag) {\n              return;\n            }\n            fixedFlag = false;\n            return ol.css({\n              \"position\": \"static\",\n              \"left\": null,\n              \"right\": null,\n              \"width\": null\n            });\n          }\n        };\n      })(this);\n      return window.addEventListener(\"scroll\", this.scrollHandler, false);\n    },\n    beforeRemove: function() {\n      $(this.m).off(\"projection_updated.chapter_link\", this.updateSelectedTitle);\n      return window.removeEventListener(\"scroll\", this.scrollHandler);\n    },\n    beforeReload: function() {\n      $(this.m).off(\"projection_updated.chapter_link\", this.updateSelectedTitle);\n      return window.removeEventListener(\"scroll\", this.scrollHandler);\n    },\n    events: {\n      \"click ol > ol\": \"selected_paragraph\",\n      \"click div > ol > li a\": \"selected_chapter\"\n    },\n    selected_paragraph: function(e) {\n      return $(e.currentTarget).siblings(\"ol\").hide(speed);\n    },\n    selected_chapter: function(e) {\n      $(e.currentTarget).next(\"ol\").show(speed);\n      return $(e.currentTarget).next(\"ol\").siblings(\"ol\").hide(speed);\n    }\n  });\n\n}).call(this);\n</script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='start_page_layout_template'><div class=\"row\"><div class=\"span12\"><h3>Вместо начала</h3><p data-tr=\"first_chapter\"></p><p data-tr=\"second_chapter\"></p></div></div></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='server_summary_widget_template'><h3>Server summary</h3></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='practice_summary_widget_template'><p>В данном разделе будут представлены описаны практические проблемы и возможные пути их решения,\n&nbsp;а также представленны различные трюки.</p><p>С течением времени база таких практик будет пополняться.</p></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='general_summary_widget_template'><h3>Общая часть</h3><p data-tr=\"p_pre\"></p></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='client_summary_widget_template'><h3>Разработка под клиент</h3><p>Some text</p></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='chapter_page_layout_template'><div data-widget-view=\"chapter\" data-projection=\"tutorial_chapter\"></div></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='index_page_layout_template'><div data-widget-view=\"summary\" data-projection=\"tutorial_section\"></div></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='general_index_widget_template'><ol><li><a data-route=\"/general/env\">Окружение</a></li><ol class=\"subsection\"><li><a data-route=\"/general/env/lang\">Язык программирования</a></li><li><a data-route=\"/general/env/interpreter\">Интерпретатор</a></li><li><a data-route=\"/general/env/os\">Операционная система</a></li><li><a data-route=\"/general/env/db\">База данных</a></li><li><a data-route=\"/general/env/ide\">Среда разработки</a></li><li><a data-route=\"/general/env/browser\">Браузер</a></li><li><a data-route=\"/general/env/node\">Node.JS и NPM</a></li><li><a data-route=\"/general/env/mongo\">MongoDB</a></li></ol><li><a data-route=\"/general/hello_world\">Hello wolrd!</a></li><ol class=\"subsection\"><li><a data-route=\"/general/hello_world/start\">Инициализация и запуск приложения</a></li><li><a data-route=\"/general/hello_world/dir_structure\">Структура папок проекта</a></li><li><a data-route=\"/general/hello_world/client\">Содержание клиента</a></li><li><a data-route=\"/general/hello_world/client_structure\">Структура клиента</a></li><li><a data-route=\"/general/hello_world/pages\">Страницы</a></li><li><a data-route=\"/general/hello_world/packages\">Пакеты</a></li><li><a data-route=\"/general/hello_world/widgets\">Виджеты</a></li><li><a data-route=\"/general/hello_world/server\">Наполнение сервера</a></li><li><a data-route=\"/general/hello_world/MVC\">MVC</a></li><li><a data-route=\"/general/hello_world/models\">Модели данных</a></li><li><a data-route=\"/general/hello_world/apis\">Сервер API</a></li><li><a data-route=\"/general/hello_world/data_manipulation\">Работа с данными на клиенте</a></li></ol><li><a data-route=\"/general/basic_spa\">Введение в Single Page Application</a></li><ol class=\"subsection\"><li><a data-route=\"/general/basic_spa/plus_and_minus\">Проблемы и преимущества</a></li><li><a data-route=\"/general/basic_spa/spa_vs_ssr\">Толстый клиент vs Server-Side рендеринг</a></li><li><a data-route=\"/general/basic_spa/spa_vs_native\">Толстый клиент vs Native Аpp</a></li></ol><li><a data-route=\"/general/paradigms\">Размышления о парадигмах</a></li><ol class=\"subsection\"><li><a data-route=\"/general/paradigms/oop\">OOP</a></li><li><a data-route=\"/general/paradigms/mvc\">MVC</a></li><li><a data-route=\"/general/paradigms/rest\">REST</a></li></ol><li><a data-route=\"/general/deep_spa\">Погружение в spa</a></li><ol class=\"subsection\"><li><a data-route=\"/general/deep_spa/mvc\">MVC на сервере и на клиенте</a></li><li><a data-route=\"/general/deep_spa/data_management\">Управление данными</a></li><li><a data-route=\"/general/deep_spa/data_sync\">Синхронизация данных</a></li><li><a data-route=\"/general/deep_spa/access_control\">Управление доступом</a></li><li><a data-route=\"/general/deep_spa/persistent\">Персистентность данных (offline-приложения)</a></li><li><a data-route=\"/general/deep_spa/views\">Отображение данных</a></li><li><a data-route=\"/general/deep_spa/client_structure\">Стуктура клиента</a></li><li><a data-route=\"/general/deep_spa/routing\">Навигация по сайту (роутинг)</a></li><li><a data-route=\"/general/deep_spa/client_patterns\">Паттерны структуры клиента</a></li><li><a data-route=\"/general/deep_spa/client_modules\">Модули клиента</a></li><li><a data-route=\"/general/deep_spa/uix\">Взаимодействие с пользователем</a></li><li><a data-route=\"/general/deep_spa/active_gui\">Активные элементы GUI</a></li><li><a data-route=\"/general/deep_spa/seo\">Проблемы индексации и SEO</a></li></ol></ol></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='client_index_widget_template'><ol><li class=\"section\"><a>Введение в Single Page Application</a></li><ol><li class=\"subsection\"><a>Построение клиента</a></li></ol></ol></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='basic_spa_general_chapter_widget_template'><h3>Введение в Simgle Page Application</h3><p>После того как мы слегка окунились в одностроничное приложение и посмотрели как это все работает, думаю,\n следует сделать перерыв и поговорить на тему одностраничек в целом. Я уверен, что большинство более\n менее опытных программистов не найдут в этом разделе чего-то принципиально нового, так как идея SPA\n уже совсем не нова и мусолилась в Интернете на различных рессурсах не один раз.</p><p>В тоже время я нахожу данный топик достаточно важным по той простой причине, что полноценных качественных одностраничек\n в интернете и в рунете в частности еще пока не так немного, и множество технических вопросов здесь остается не решенным\n даже на концептуальном уровне.</p><p>Целью всего этого проекта было выражение мыслей о возможных путях решения проблем организации SPA в программном коде библиотеки.\n И я нахожу естественным начать обсуждение этих идей с самых общих вопросов, а именно определении, назначении и жизнеспособности одностраничек.</p><p>Если вас мало интересуют общефилософские вопросы веба, то вы можете смело пропустить эту и следующу главы и сразу обратиться к главе <a data-route='/general/deep_sap'>погружение в SPA</a>.\n Там вы найдете необходимый набор информации о том как создать веб-приложение с помощью Muon.js. Для всех же остальных - буду рад похоливарить с вами\n о судьбе веба в комментариях к данной главе.</p><h4>О сущности SPA. Проблемы и преимущества.</h4><p> Начну данный раздел с того, что раскрою одну очень важную тайну. JavaScript-программисты не любят верстку и ненавидят DOM.\n Никто об этом не знал, даже я до недавнего времени, но это горькая и правда.\n Это конечно же шутка, и все же она в некоторой степени имеет отношение к появлению одностраничных приложений.</p><p>В общем случае одностраничное приложение представляет собой насыщенный веб-клиент, который заранее включает в себя все возможные\n действия, логические страницы и переходы между ними. Обычно такое приложение заранее формирует весь необходимый контент и помещает его в один большой\n <b>index.html</b> файл, а все что по тем или иным причинам не может быть включено в страницу,\n догружает по мере общения приложения с пользователем, а также сервером  по средством AJAX-запросов.\n При этом организации как клиента, так и сервера для создания одностраничного сайта может быть произвольной.</p><p>Самый банальный пример, когда одностраничный клиент создается на базе обычного\n <b>многостраничного</b> сайта, который помещается в специальную оболочку, отслеживающую переходы по внутренним ссылкам. Вместо полноценной перезагрузки браузера, оболочка подгружает\n содержимое сайта с сервера, и без обработки отображает его на экране браузера. Это позволяет добиться более \"гладкой\" визуальной работы сайта и исключить эффект\n перезагрузки странциы, когда содержимое сайта на время исчезает (особенно заметно при медленном соединении). Данный метод, например, использует система страниц в <a href='http://jquerymobile.com/' target='new'>jquery-mobile</a>.</p><p>На самом деле преимуществ использования одностраничек значительно больше. Прежде чем рассматривать их более подробно нужно сделать две важные заметки.\n Когда говорят об одностраничных приложениях, всегда подразумевают <b>клиент</b> или точнее <b>толстый клиент</b> и его организацию. Из этого следует, что говоря о разработке SPA,\n подразумевают в первую очередь именно браузерную часть приложения, не затрагивая при этом особенности работы сервера, полагая, что он работает как обычно, и\n единственной его заботой является - отдать цельный файл <b>index.html</b>, а также уметь правильно общаться по <b>AJAX'y</b>. В то же время сама специфика использования\n <b>толстого клиента</b> предполагает перенос значительной части бизнес логики приложения с сервера в браузер, что не может не сказаться на программной организации <b>back-end'a</b>.\n Здесь и везде в рамках туториала и документации я буду безусловно делать акцент на построении клиента, и тем не менее, я считаю, что значительная часть преимуществ\n SPA может быть достигнута в первую очередь за счет оптимизации работы как сервера так и клиента.</p><p>Вторая заметка относится к термину <b>Single Page Application</b> и конкретно к слову <b>application</b> - <b>приложение</b>. Я считаю, что неспроста\n данный термин был применен именно к приложениям (хотя наиболее употребим в контексте веб-сайта). Тренд по усложнению и насыщению функциональными возможностями современных веб-сайтов,\n приближающий их к уровню настольных приложений, существует уже достаточно давно. Более того, в настоящий момент существует достаточное количество\n развитых веб-приложений, которые по удобству использования не уступают современным нативным приложения. В данном случае я говорю о таких\n приложениях как сервисы Google, почтовые и картографические приложения Mail и Яндекс, социалки <a target='new' href='http://vk.com'>VK</a> и <a target='new' href='http://fb.com'>Facebook</a>, приложения <a target='new' href='http://asana.com'>Asana</a>,\n <a target='new' href='http://lucidcharts.com'>Lucidcharts</a> и т.д. Данный тренд, как мне кажется, будет длиться еще достаточно долго, и еще не скоро мы увидим воплощенный в реалии идеальный мир\n Google, когда единственным приложением на компьютере окажется браузер, а все ПО будет размещено в сети на облачных серверах.\n Тем не менее сам по себе тренд является очень позитивным и значительно способствует развитию веб-технологий в целом.\n В конечном счете основной целью одностраничных приложений является предоставление <b>пользовательского опыта</b>\n (юзабилити, user experience) сравнимого с анлогичным для классических <b>настольных приложений</b>. Безусловно в рамках веб-сайта оказывается достаточно\n тяжело отойти от присущих ему особенностей, как технических, таких как контекст браузера, так и содержательных (особенности контента).\n И все же это не отменяет возможность переноса паттернов пользовательского опыта, сформированных за несколько десятилетий развития настольных приложений,\n в плоскость веба. Как факт, удобство пользовательского интерфейса является главным мерилом качества разработанного приложения,\n не уступая в этом смысле качеству и адекватности реализации своих фукнций.</p><p>К чему я все это говорю. Мое видение одностраничных приложений, как и в общем цель создания библиотеки Muon.js, сводится не просто к желанию загнать содержимое всего\n сайта в один запрос к серверу и тем самым уменьшить время отклика на действия пользователя, а скорее к попытке определить общие принципы построения одностраничного\n клиента, организации взаимодействия его внутренних элементов, способов обработки и отображения данных, а также протокола взаимодействия с сервером.\n Все это делается ради достижения тех качеств которые выгодно отличают полноценные приложения от обычных сайтов. В частности к ним можно отнести:</p><ul><li>Перенос бизнес логики приложения за пределы сервера в клиент, при этом каждый экземпляр клиента обладает автономным контекстом.</li><li>Сервер участвует в формировании и изменении контекста клиента только в тех случаях, когда этого требует логика приложения.</li><li>Изменение данных контекста приводит к соответствующим автоматическим изменениям в пользовательском интерфейсе приложения.</li><li>Работа приложения не обязана привязываться к работе сервера, может выполняться в offline-режиме, либо вообще не предполагать наличия удаленного сервера.</li><li>Сервер в рамках одностраничного приложения выступает в качестве централизованного хранилища данных, а также контроллера, разграничивающего\n доступ к данным с различных клиентов</li><li>В случае, если два и более клиента используют одни и те же ресурсы (данные), синхронизация состояний этих ресурсов должна осуществляться\n автоматически в режиме реального времени.</li></ul><p>Сразу сознаюсь, что я во многом лукавлю, называя все выщеперечисленное положительными качествами одностраничек: намного правильнее было бы обозвать все\n это <b>требованиями</b> к идеальному веб-приложению. В конечном счете эти требования направлены на достижение двух основных преимуществ: высокая степень\n интерактивности приложения и снижение вычислительной нагрузки на сервер. Однако за всем этим скрыто также еще и третье весьма значимое свойство. За счет того, что мы исключаем\n сервер из процесса формирования клиента, появляется возможность использования нескольких альтернативных вариантов клиента в рамках одного приложения. Наиболее\n характерный пример - это работа приложения в браузере на десктопе, в мобильном браузере, а также в рамках мобильного приложения. Очевидно, что все три перечисленных\n формфактора обладают качествами, которые плохо сочетаются друг с другом в рамках одного клиента. Безусловно наличие одностраничного приложения не лишает нас\n необходимости разрабатывать три независимых приложения, в тоже время исключение серверной составляющей из бизнес логики приложения позволяет сократить объем\n работы как минимум в два раза.</p><p>Очевидно, что наряду с перечисленными достоинствами одностраничных сайтов перед классическими у них есть и свои недостатки. Первая проблема заключается собственно в том,\n что все обозначенные свойства приложения нужно в той или иной степени удовлетворить и реализовать. И если для обычных сайтов принципы их построения во многом устоялись\n и определены, а для их создания существует достаточное количество \"взрослых\" фреймворков, то в случае с SPA здесь все оказывается не так просто как хотелось бы.</p><p>Вторая и наиболее существенная составляющая заключается в техническом обеспечении одностраничных приложений со стороны браузеров. Вполне уместно утверждать,\n что одностраничные сайты - это история не про старые браузеры. Полноценная поддержка таких функций, как история адресной строки (History), веб-сокеты,\n локальные хранилища, а также прочих удобств, которые значительно упрощают процесс создания развитых приложений, есть даже не во всех современных браузерах,\n (в первую очередь мобильных), не говоря уже о старых версиях Internet Explorer. Во многом именно это является основным тормозом в развитии веб-приложений, так как\n значительная часть коммерческих сайтов ориентирована на максимально широкую аудиторию пользователей, и соответтсвенно должна поддерживать работу старых браузеров.</p><p>К третьей проблеме SPA следует отнести сложность их индексации. Подавляющая часть Интернета до сих пор строится на том, что чтобы получить весь необходимый контент\n конкретной страницы веб-сайта, достаточно отправить соответствующий запрос на сервер. Логика работы одностраничного сайта не укладыватся в это правило, так как вне\n завиcимости от запроса сервер всегда будет отвечать одним и тем же не включющим как либо полезных для поискового робота данных ответом.\n Очевидно, единственный решением данной проблемы может быть использование дополнительных средств и инструментов, помогающих поисковым роботам\n осуществлять индексацию сайта, в частности специальные фильтры запросов для сетевых ботов, а также генераторы карт приложения <a href='http://sitemaps.org' target='new'>Sitemap</a>.</p><p>О том как обойти эти, а также другие ограничения одностраничных приложений вы можете прочитать в соответствующих главах <a data-route='/general/deep_sap'>5-го раздела</a>. В целом же\n могу сказать, я не считаю, что какая либо из перечисленных проблем не является поводом, чтобы не использовать принцип одностраничных приложений на своих проекта. Более того,\n можно ожидать, что со временем в процессе развития как браузеров, так и поисковых систем, все перечисленные выше проблемы сойдут на нет, в то время как достоинства\n проявят себя в полную силу. В любом случае, даже сейчас одностраничные приложения имеют право на жизнь, собственно, как раз цель данного туториала и ресурса в целом\n и заключается в том, чтобы доказать это.</p><h4>Толстый клиент vs Service-Side Rendering</h4><p>Тип приложений (сайтов), в которых клиент формируется каждый раз в соответствии с запросом поступившим на сервер, до сих пор доминирует в Интернете.</p><h4>Толстый клиент vs Native App</h4><h4>А также сервер</h4></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='paradigms_general_chapter_widget_template'><h3>Размышление о парадигмах</h3><p>Данный раздел как и предыдущий также будет посвящен общим вопросам программирования в применении к одностраничным сайтам.\n Здесь вы не найдете конкретных рецептов решения той или иной проблемы организации SPA,\n но в тоже время именно в данном разделе будут описаны основополагающие принципы, определяющие пути решения этих проблем.\n На мой взгляд это далеко непростая тема для обсуждения, так как ни одна из современных парадигм,\n даже при достаточно четкой формулировке не может дать конкретного ответа на вопрос \"как именно следует\n организовывать код\", как правило оставляет большой простор для размышлений и всевозможных интерпретаций, и, как следствие,\n является причиной религиизных споров между почитателями тех или иных веб-фреймворков. Исходя из того, что имеено в\n споре рождается истина и крутые сайты, этому топику я решил уделить особое внимание.</p><p>Как и в любых других общефилософских вопросах, я оставлю за собой право ошибаться в каких-то оспектах и нюансах данной темы.\n Более того, уверен, что среди читателей найдутся специалисты, более глубоко понимающие все тонкости веб технологии, чем я.\n Комментариям таких людей я буду очень рад. В данном случае я выражаю собственное видение, которое легло в основу всей библиотеки.</p><p>С учетом того, что библиотека охватывает как сервер, так и клиент, все рассматриваемые проблемы я будут рассматривать в приложении\n ко всей инфраструктуры одностраничного сайта. И так, поехали.</p><h4 data-focus=\"mvc\">Модель Представление Контроллер (MVC)</h4><h4 data-focus=\"oop\">Объектно Ориентированное Программирование</h4><h4 data-focus=\"rest\">REST</h4></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='hello_world_general_chapter_widget_template'><h3 class=\"title\">Hello, wolrd!</h3><br/><p>В данном разделе, пользуясь средствами фреймворка<strong> Muon</strong> мы создадим первое пробное приложение.\n В дальнейшем во всех главах этого и остальных разделов мы будем использовать его для демонстрации\n возможностей библиотеки, а также обсуждения проблем построения SPA.</p><h4 id=\"start\" class=\"title\">Инициализация и запуск приложения</h4><p> В качестве Hello, world!\n проекта в веб разработке принято брать приложения типа аля'Twitter или планировщики заданий. В рамках этой главы\n нам конечно же не удастся создать законченный продукт. Пока я ограничусь тем, что покажу, как инициализировать\n проект и создать первые элементы интерфейса. Предлагаю в рамках данного туториала создать календарь с элементами\n планировщика заданий. Называться наш проект будет<strong> SuperCalendar</strong>.</p><p>Первым шагом инициализации проекта Node.js является\n создание в корневой директории проекта файла<strong> package.json</strong>, в котором дается его описание, включая название, назначение, автора, версию и т.д.\n (данная информация нужна главным образом для публикации проекта в&nbsp;\n реестре пакетов NPM), а также приводится список зависимостей.</p><p>Для инициализации проекта в библиотеку<strong> Muon</strong> включена программа<strong> m-init</strong>, которая сама создает и заполняет директорию проекта необходимыми исходными подкаталогами и файлами, в соответствие с требованиями\n библиотеки, а также создает заготовку<strong> package.json</strong>.</p><p>Для запуска<strong> m-init</strong> нам необходимо предварительно выполнить глобальную установку библиотеки<strong> Muon</strong>:</p><br/><pre class=\"prettyprint\">foo:~$ npm install -g muon</pre><br/><div class=\"mark\"><h5>Внимание!</h5><p>Если Вы устанавливали Node.js так, как это описано в данном разделе выше, то глобальная установка пакетов не\n потребует прав администратора. В том случае, если Вы воспользовались готовым APT пакетом, либо разместили\n библиотеку вне домашней директории, то для выполнения данного действия вам возможно потребуются права администратора.\n В этом случае команду, указанную выше, вам необходимо выполнить через<strong> sudo</strong>.</p><p>Из соображений безопасности система<strong> sudo</strong> в последних версиях дистрибутивов подменяет переменные окружения на стандартные, поэтому команды<strong> npm</strong> может не оказаться среди директорий, обозначенных в<strong> $PATH</strong>. В этом случае вам необхохдимо будет вызвать npm, указав полный путь до исполняемого файла.</p></div><br/><p>Работа m-init крайне проста. Для инициализации проекта необходимо вызывать программу, передав ей единственный аргумент -\n название проекта.</p><br/><pre class=\"prettyprint lang-sh\"><span>foo:~$ m-init SuperCalendar</span><br/><span>...</span><br/><span>Complete!</span><br/><span>foo:~$ cd SuperCalendar</span></pre><br/><p>В ходе работы программы будет создана директория, в которую будут скопированы файлы<strong> шаблонного</strong> проекта. Последним этапом по созданию проекта является установка зависимостей. В файле<strong> package.json</strong> только что созданного проекта Вы обнаружите, что в число зависимостей добавлен только один модуль<strong> Muon</strong>, который собственно и отвечает за работу всего приложения. Установка зависимостей выполняется с помощью метода<strong> npm install</strong>:</p><br/><pre class=\"prettyprint lang-sh\"><span>foo:~/SuperCalendar$ npm install</span><br/><span>npm http GET https://registry.npmjs.org/Muon</span><br/><span>npm http 200 https://registry.npmjs.org/Muon</span><br/><span>...</span></pre><br/><p>Как только npm установит все зависимости, мы сможем запустить приложение. Также как и в большинстве\n других Node.js проектов, библиотека включает собственный веб сервер (созданный на базе<strong> express.js</strong> - подробнее об этом будет рассказано в соответствующей главе). Для запуска приложения достаточно\n выполнить встроенную в библиотеку утилиту<strong> m-start</strong>.</p><br/><pre class=\"prettyprint\"><span>foo:~/SuperCalendar$ m-start</span><br/><span>Server started in development mode, listening on 0.0.0.0:8000 address.</span><br/><span>...</span></pre><br/><p>По умолчанию сервер прослушивает адрес 0.0.0.0 на\n 8000-м порту. Указав в браузере данный адрес, Вы увидете приветственную страницу проекта.</p><div class=\"tutor-img\"><img data-src=\"hello_screenshot.png\"/></div><p>Наш проект готов. В данном случае мы получили заготовку будущего сайта, которую можно и нужно править.</p><h4 id=\"dir_structure\" class=\"title\">Структура папок проекта</h4><p>Просматривая директорию проекта Вы обнаружите приблизительно следующую структуру:</p><div style=\"float: left; width: 230px; margin-right: 20px\" class=\"code\"><strong>client/</strong><br/><span>|| assets/</span><br/><span>|--| ...</span><br/><span>|| packages/</span><br/><strong>|--| application/</strong><br/><span>|----| ...</span><br/><strong>|----| views/</strong><br/><strong>|----| package.js</strong><br/><strong>|| index.html</strong><br/><strong>server/</strong><br/><span>|| app/</span><br/><span>|--| controllers/</span><br/><span>|--| initialisers/</span><br/><span>|--| middleware/</span><br/><strong>|--| models/</strong><br/><span>|--| helpers/</span><br/><span>lib/</span><br/><span>|| plugin_loader.js</span><br/><span>tmp/</span><br/><strong>config.json</strong><br/><span>package.json</span><br/><span>README.md</span></div><p>Если Вы занимались разработкой веб-сайтов на других фреймворках, то заметите ряд общих черт, например, наличие в клиентской части файла<strong> index.html</strong> и папки<strong> assets</strong> в которой вполне ожидаемо будут размещаться статичные файлы приложения, в частности CSS- и JS-файлы, изображения,\n шрифты и т.д. В серверной части приложения Вы обнаружите набор каталогов, содержащих описание<strong> моделей</strong> данных и сопутсвующих им JavaScript-модулей.</p><p>Из наиболее превычных можно также выделить файлы<strong> package.json</strong> и<strong> README.md</strong>.</p><p>Про файл <strong>package.json</strong> я уже писал выше. Он отвечает за описание вашего Node.js проекта, включая внешние зависимости, а также информацию,\n необходимую для публикации проекта в реестре NPM. Я не буду сильно заострять внимание на содержимом данного файла, подробную информацию об этом\n Вы можете найти <a target='new' src='https://npmjs.org/doc/json.html'>здесь</a>. Некоторые моменты, касающиеся содержания\n данного файла, будут отмечаться на протяжении всего туториала. Пока что Вам нужно знать, что единственной обязательной\n зависимостью является непосредственно библиотека Muon, что должно быть отражено в переменной<strong> dependencies</strong>.</p><p>Вполне очевидно, что файл <strong>README.md</strong> предназначен для хранения краткого описания вашего проекта. Данный файл будет\n автоматически учтен при публикации на github'e и других аналогичных сервисах.</p><p>Помимо данных файлов в корне проекта находится файл<strong> config.json</strong>, который содержит информацию, необходимую для инициализации Muon-проекта. Просматривая содержимое данного файла,\n, Вы найдете там переменные, хранящие адрес и порт, к которым выполняется привязка веб-сервера, базы данных, стандартную локаль проекта,\n а также перечень Muon-плагинов, из которых будет собрано приложение (более подробно о плагинах в структуре Muon-проекта\n будет рассказано в разделе туториала, посвященной серверной части библиотеки).</p><p>Оставшиеся неописанные директории - <strong>lib</strong> и <strong>tmp</strong>\n - имеют служебное значение. В первой хранится JS-модуль, ответственный за формированние плагинной структуры проекта.\n Директория tmp предназначена для размещения временных файлов, а также файлов, загруженных на сервер из Интернета.</p><p>Из представленной структуры видно четкое разделение приложения на <strong>серверную</strong> и <strong>клиентскую</strong> части. В классических фреймворках\n с рендерингом старниц на серверной стороне (Rails, Django, Yii), формирование клиента было полностью заботой сервера -\n рендеринг страниц осуществлялся с каждым запросом наравне с обращением к базе данных, обработкой данных моделей и т.д.\n В одностраничных приложениях сервер безусловно также принимает участие в генерации клиента (далее мы увидим, как это происходит),\n однако выгрузка HTML-кода клиента в браузер осуществляется не с каждым запросом, а только один раз при первом запросе (в виде одного большого скомпилированного <strong>index.html</strong> файла).\n Далее уже на стороне браузера клиент определяет, какой именно запрос был сделан, и выполняет все сопутствующие ему\n действия. Все остальные запросы из загруженного клиента к серверу сводятся (в упрощенном варианте) к выборке данных моделей в JSON виде.</p><p>Из этого описания хорошо видно, как сильно оказываются развязаны клиентская и серверная составляющие приложения. Это\n одно из наиболее значимых преимуществ SPA, так как отделив сервер от клиента, у нас появляется возможность менять поведение клиента\n и интерфейс, не беспокоясь о вопросах целостности данных, безопасности и&nbsp;т.&nbsp;д. (при этом предполагается, что сервер уже\n обеспечивает все эти свойства приложения). Данная особенность в свою очередь упрощает процесс разработки под разные таргетинговые платформы\n и аудитории, что безусловно является большим плюсом (более подробно о преимуществах и недостатках одностраничных сайтов мы поговорим в следующих разделах).</p><h4 id=\"client\" class=\"title\">Содержание клиента</h4><p><strong>Клиентская</strong> составляющая хранит в себе все то, что в конечном счете в том или ином виде будет показано пользователю в окне браузера,\n и с чем он будет непосредственно взаимодействовать (пользовательская логика). Одностраничное приложение\n безусловно можно было бы написать в одном единственном HTML-файле, однако, обеспечить более менее значимую сложность и функциональность\n приложения в таком случае будет непросто. По этой причине одной из наиболее критичных задач связанных с построением клиента является\n <strong>структуризация</strong> и <strong>декомпозиция</strong> клиента.</p><p>Для удобства разработки <strong>толстый клиент</strong> может быть разбит на части и представлен в виде\n совокупностей взаимодействующих элементов интефрейса - <strong>виджетов</strong>. Те, кто знаком с разработкой пользовательских интерфейсов для\n настольных прилжоений (MFC, VCL, QtGui и т.д.), помнят назначение виджетов (widgets). В Muon интерфейс пользователя\n строится как \"конструктор\" из вложенных частей, которыми виджеты и являются.</p><p>Основной задачей виджетов, как например в случае с C++ библиотекой <a href='http://qt-project.org' target='new'>QtGui</a>,\n является формирование законченных логических элементов интерфейса, выполняющих одну конкретную задачу. Это могут быть\n дата пикеры, прогрес бары, формы ввода, диалоговые окна - все что так или иначе может потребоваться для решения небольших частных задач.\n В общем случае, я считаю, целесообразно выводить все более-менее значимые <strong>паттерны</strong> пользовательского интерфейса в отдельные виджеты,\n тем самым обеспечивая повторное использование программного кода.</p><p>Более подробно о существующих паттернах UI и UIX в вебе мы поговорим по мере написания нашего Супер Календаря. Однако уже сейчас вполне возможно\n затронуть наиболее распростарненные из них. В первую очередь к ним отностися веб-старинца.</p><h5 id=\"client_structure\" class=\"title\">Структура клиента</h5><p>C точки зрения классического сайта наличие самого понятия \"веб-старница\" (<strong>page</strong>) вполне понятно и оправданно, чего нельзя сказать про<strong> одностраничные</strong> приложения. И все же страница в SPA имеет смысл. Если проводить аналогию SPA с настольными приложениями, то под страницей можно понимать один из экранов приложения -\n логически связанный набор элементов интерфейса, и информационная выборка, которые вместе реализуют один из наиболее крупных пользовательских кейсов приложения.\n На самом деле, такое определение полностью подходит и для страницы классического сайта. Кроме этого для сайтов,\n как правило, каждой странице соответствует определенный маршрут (или семейство маршрутов) в адресной строке браузера, по которому она может быть доступна в Интернет.</p><p>Помимо этого как для сайтов, так и настольных приложений характерно наличие элементов интерфейса, которые размещены на экране вне зависимости\n от текущей отображаемой страницы, и формируют общее обрамление сайта. Это обрамление формирует второй структурный паттерн\n веб-сайта, который я назвал общим словом<strong> приложение</strong> или<strong> application</strong>. Как правило application содержит в себе элементы пользовательского интерфейса, ответственные за навигацию по сайту, (например, такие как <a data-hover='.navbar-fixed-top > .row'>navbar</a> вверху экрана\n или <a data-hover='[data-muon=\"index_widget\"]'>статичное оглавление</a> справа), рекламные банеры, управляющие элементы <a data-hover=\"[data-widget-view=signin]\">аккаунта</a>,\n а также любые другие элементы интерфейса.</p><p>Собственно, задача application сводится к тому чтобы объединить все существующие экраны в одно единое одностраничное приложение и предоставить возможность сайту\n переключать их между собой по мере надобности. Выглядеть это должно примерно так, как показано на рисунке.</p><div class=\"tutor-img\"><img data-src=\"app_page_struct.png\"/></div><p>На самом деле, наш <strong>Супер Календарь</strong> уже обладает такой структурой. Убедиться в этом Вы можете, указав произвольный путь в рамках URL, например,\n <strong>localhost:8000/wrong_page</strong>. В ответ Вы увидете страницу с заголовком, но уже без приветствия. Очевидно, что\n заголовок и текстовый логотип принадлежат application, в то время как содержательный текст относится к конкретной странице 404.</p><div class=\"tutor-img\"><img data-src=\"wrong_page.png\"/></div><h5 id=\"pages\" class=\"title\">Страницы</h5><p>Думаю, самое время попробовать добавить несколько страниц в наш календарь. Добавление страниц в приложение состоит из трех шагов: в первую очередь необходимо задать адреса\n по которым эти страницы будут доступны на сайте; во-вторых, создать файлы, в которых мы опишем содержание (верстку) создаваемых страниц.\n Последнее, что мы должны сделать, - это обеспечить возможность перехода между страницами, добавив соответствующие ссылки на них в приложение.</p><p>Предположим, что для нашего календаря потребутся следующие страницы:</p><ul><li>страница выбора даты,</li><li>страница просмотра почасового рассписания на день,</li><li>страницы добавления, просмотра и редактирования задач на день (заметок).</li></ul><p>Первым делом нам необходимо зарегистрировать пять различных путей на нашем сайте. Это:</p><ul><li><i>/</i> - главный экран приложения</li><li><i>/calendar</i> - выбор даты</li><li><i>/day_schedule</i> - отображение расписания на день</li><li><i>/note</i> - показ заметки</li><li><i>/note/add</i> - добавление заметки</li><li><i>/note/edit</i> - редактирование заметки</li></ul><p>Для этого нам необходимо отредактировать содержимое файла<strong> /client/packages/application/package.js.</strong> Данный файл выполняет роль дескриптора клиентского приложения (точнее одного из его пакетов - об этом будет\n рассказано далее). В исходном состоянии он должен выглядеть примерно так:</p><p><strong>/client/packages/application/package.js:</strong></p><pre class=\"prettyprint\">module.exports = {<br>\n  useAppLayout: true,<br>\n  pages: [\"*\"],<br>\n  models: [\"*\"],<br>\n  middleware: [],<br>\n  routes: [<br>\n      {<br>\n          route: \"\"<br>\n      },<br>\n      {<br>\n          route: \"*a\",<br>\n          page: \"error\"<br>\n      }<br>\n  ],<br>\n  surrogate: {}<br>\n}</pre><p>Содержание файла напоминает <a target='new' href='http://en.wikipedia.org/wiki/Asynchronous_module_definition'>AMD нотацию</a>: дескриптор клиента (пакета) помещается в переменную <strong>module.exports</strong>.\n По содержанию файла становится вполне очевидно, что нас интересует атрибут <strong>routes</strong>. В данном случае\n клиент уже содержит два объявленных пути (корень \"\", и произвольный путь \"*a\"), нам же необходимо привести содержимое атрибута к следующему виду:</p><pre class=\"prettyprint\">routes: [<br>\n    { route: \"\" },<br>\n    { route: \"calendar\" },<br>\n    { route: \"day_schedule\" },<br>\n    { route: \"note\" },<br>\n    { route: \"note/add\" },<br>\n    { route: \"note/edit\" },<br>\n    {<br>\n        route: \"*a\",<br>\n        page: \"error\"<br>\n    }<br>\n]<br></pre><div class=\"mark\"><h5>Клиентский роутинг</h5><p>Те, кто занимался разработкой SPA, знают о библоитеке <strong>Backbone</strong>,\n которая лежит в основе Muon. Muon расширяет объект маршрутизации <strong>Backbone.Router</strong> и реализует немного\n иной подход к построению дерева маршрутов на клиенте. В то же время синтаксис для определения маршрута\n полностью соответствует синтаксису, используемому в Backbone: Вы можете использовать\n как прямые записи в виде строк, так и упрощенные регулярные выражения для указания в маршруте опциональных параметров.\n В данном случае запись '*a' соответствует любому набору символов, включая символ слэш '/'.\n Подробней о маршрутах в Backbone Вы можете узнать из <a target='new' href='http://backbonejs.org/#Router'>документации</a> Backbone.</p><p>Заметьте также, что в отличие от атрибута <strong>routes</strong>, задаваемого при создании объекта <strong>Backbone.Router</strong>,\n в нашем случае этот атрибут является не объектом, а массивом.</p><p>Более подробно работа системы клиентской маршрутизации в Muon будет рассмотрена в соответствующих главах данного туториала, а также\n также отдельного туториала, посвященного разработке под клиент.</p></div><p>Следующее, что нам требуется, -  это добавить файлы с разметкой страниц в состав клиента. Для этого в директории<strong> /client/packages/application/layout/page/</strong> необходимо создать дополнительно три директории с именами <strong>calendar</strong>, <strong>day_schedule</strong> и\n <strong>note</strong>, а в созданной директории <strong>note</strong> еще две: <strong>add</strong> и <strong>edit</strong>.\n В каждой из созданных директорий нужно создать HTML- и CSS-файлы с соответствующими именами. Например <strong>calendar.html</strong>.\n В конечном счете относительно указанной директории у Вас должна получиться следующая структура файлов и папок.</p><ul><li>./calendar/calendar.html</li><li>./calendar/calendar.css</li><li>./day_schedule/day_schedule.html</li><li>./day_schedule/day_schedule.css</li><li>./note/note.html</li><li>./note/note.css</li><li>./note/add/add.html</li><li>./note/add/add.css</li><li>./note/edit/edit.html</li><li>./note/edit/edit.css</li></ul><p>Мы не брали в расчет главную страницу сайта, относящуюся к корневому адресу \"\", так как она уже присутствует в директории\n под названием <strong>index</strong>.</p><p>Думаю, должно быть понятно, что содержание файлов <strong>calendar/calendar.html</strong> и <strong>calendar/calendar.css</strong>\n отвечает за содержание и внешний вид (стиль) объявленной страницы <strong>calendar</strong>. Тоже самое верно и для остальных созданных страниц.</p><p>Чтобы не тратить слишком много времени, мы продолжим работать только с двумя страницами: <strong>index</strong> и <strong>calendar</strong>.\n Файлы верстки HTML будут иметь следующее содержание:</p><p><strong>/client/packages/application/layout/page/index/index.html:</strong></p><title>= \"<h1>Welcome to the Super Calendar</h1>\"</title><data>= \"<p>This is the main page of the Calendar</p>\"</data><pre class=\"prettyprint lang-html\"><br/></pre><p><strong>/client/packages/application/layout/page/calendar/calendar.html:</strong></p><title>= \"<h1>Date picker page</h1>\"</title><data>= \"<p>We will be able to choose a date on this page soon</p>\"</data><pre class=\"prettyprint lang-html\"><br/></pre><div class=\"mark\"><p>В директории, соответствующей главной странице, вместо HTML и CSS файлов размещены шаблонные файлы с раширениями\n <strong>.jade</strong> и <strong>.less</strong>. Muon поддерживает ряд шаблонизаторов, упрощающих написание HTML и CSS кода,\n в том числе <a target='new' href='http://jade-lang.org'><strong>Jade</strong></a> и <a target='new' href='http://lesscss.org'><strong>Less</strong></a>.\n Если Вы не знакомы с синтаксисом этих шаблонизаторов, вы можете заменить расширения существующих файлов на\n <strong>.html</strong> и <strong>.css</strong> и использовать стандартный синтаксис.</p></div><p>Файлы index.css и calendar.css будут использовать единый стиль и должны иметь следующий вид:</p><p><strong>/client/packages/application/layout/page/index/index.css:</strong><br/><strong>/client/packages/application/layout/page/calendar/calendar.css:</strong></p><pre class=\"prettyprint lang-css\">h1 {<br>\n  color: gray;<br>\n  font-size: 16px;<br>\n}<br><br/>p {<br>\n  font-size: 13px;<br>\n}</pre><p>Для того, чтобы просмотреть результат изменений нам достаточно открыть страницы localhost:8000 и\n localhost:8000/calendar, и, если все было сделано правильно, Вы увидете следующее:</p><div class=\"tutor-img shadow\"><img data-src=\"page_index.png\"/></div><div class=\"tutor-img shadow\"><img data-src=\"page_calendar.png\"/></div><p>Последний момент - нам остается разместить линки на наши страницы и обеспечить навигацию между ними. Лучше всего\n сделать это в заголовке сайта (header), в том месте, где размещена надпись \"The hardest piece of work has passed!\". Как я говорил ранее,\n заголовок не относится ни к одной из объявленных страниц сайта, а размещается в структурном элементе <strong>appliation</strong>.\n Данный элемент является единственным во всей структуре сайта, и файлы с его версткой и стилями размещены в директории<strong> /client/packages/application/stack/application</strong>. Содержание файлов должно быть следующим:</p><p><strong>/client/packages/application/stack/application/application.html:</strong></p><title>= \"<h2>Super Calendar</h2>\"</title><ul>= \"<ul>\"</ul><li_main>= \"     <li><a data-route='/'>Main</a></li>\"</li_main><li_calendar>= \"     <li><a data-route='/calendar'>Calendar</a></li>\"</li_calendar><ul_close>= \"</ul>\"</ul_close><target>= \"<div id='target'></div>\"</target><pre class=\"prettyprint lang-html\"><br/><br/><br/><br/><br/></pre><p><strong>/client/packages/application/stack/application/application.css:</strong></p><pre class=\"prettyprint lang-css\">& {<br>\n  padding: 50px;<br>\n}<br><br/>ul li {<br>\n  display: inline-block;<br>\n  padding: 15px;<br>\n}<br><br/>ul li:hover {<br>\n  background-color: rgb(66,139,202);<br>\n}<br><br/>ul li:hover a {<br>\n  color: white;<br>\n  text-decoration: none<br>\n}<br></pre><p>После перезагрузки Вы должны увидеть полностью оформленную страницу календаря:</p><div class=\"tutor-img shadow\"><img data-src=\"page_with_routes.png\"/></div><p>Покликав на созданные гиперссылки вы увидете, что подменяется только содержимое, находящееся под ними, при этом\n сама страница не перезагружается (убедиться в этом можно воспользовавшись отладочной консолью браузера).\n Таким образом мы добились того, что на Супер Календарь стал немного походить на одностраничное веб-приложение.</p><h5>Разбор полетов</h5><p>Прежде, чем закончить работу со страницами, следует дать несколько пояснений к тому, что мы только что сделали.</p><p>В первую очередь следует отметить содержание и расположение файлов, описывающих наполнение страниц и элемента application.\n Все они находятся в директории <strong>/client/packages/application/views</strong>. Это место в структуре\n клиента (и приложения в целом), куда помещаются все создаваемые элементы интерфейса,\n Соответственно имя и назначение представлений (в том числе тех, что мы только что создали) определяется их\n расположением относительно указанной директории. При этом имя элемента интерфейса application имеет полное\n название <strong>application_stack</strong>, а созданных нами страниц - <strong>index_page_layout</strong>,\n <strong>calendar_page_layout</strong> и т.д. В формировании имени представления участвуют только имена вложенных папок,\n в то время как имена файлов могут иметь произвольное значение (о нюансах мы поговорим позже). Ожидается, что\n в папке, определяющей одно из представлений, может находиться три типа файлов: файл <strong>верстки</strong>, файл <strong>стилей</strong> и файл,\n описывающий <strong>логику поведения</strong> элемента интерфейса (HTML, CSS и JS соответственно), хотя наличие всех этих файлов\n опционально.</p><p>Вы наверняка заметили наличие некошерного селектора <strong>&</strong> в описании стилей <strong>application_stack</strong>.\n Файл стилей application.css ответственен за оформление конкретно данного элемента интерфейса, а определенные в нем стили\n относительны и применяются не ко всему документу, а только к верхнему (корневому) тэгу данного экземпляра представления\n и всем нижележащим дочерним тэгам. Чтобы сослаться на тэги <strong>anchor</strong>, размещенные в элементах\n (<strong>li</strong>) списка (<strong>ul</strong>),\n следует указать селектор:</p><pre class=\"prettyprint lang-css\">ul > li > a</pre><p>Он будет соответствовать любой гипперсылке, вложенной в список ul->li где угодно в рамках представления application_stack\n и, как следствие, в рамках всего документа (так как application_stack является обрамлением для всего веб-приложения).\n Следовательно, чтобы сослаться непосредственно на корневой тэг элемента, либо тэг, являющийся непосредственно\n дочерним для него, нужен специальный селектор (служебное слово), которые бы библиотека воспринимала\n соотвтетсвующим образом. В данном случае, таким селектором является символ <strong>&</strong>. В свою очередь\n запись:</p><pre class=\"prettyprint lang-css\">& { padding: 50px }</pre><p>означает, что правило <strong>padding</strong> будет применено к тэгу, лежащему в основе данного представления <strong>application_stack</strong>.</p><p>Последним неразъясненным моментом остались гипперссылки, а точнее способ указания маршрута для навигации между старницами.\n Наверняка Вы заметили, что вместо стандартного атрибута <strong>href</strong>, был использован атрибут\n <strong>data-route</strong>, в тоже время сам тэг <strong>anchor</strong> ведет себя как полноценная ссылка, и если\n проинспектировать элемент в консоли браузера, можно увидеть, что атрибут <strong>href</strong> установлен и имеет\n правильное значение. Сделано это для того, чтобы библиотека могла распознавать нажатия на внутренние ссылки приложения,\n и вместо полноценной перезагрузки страницы обращалась к объекту <strong>History</strong> браузера. В тоже время\n ссылка имеет свой адрес, и поэтому она может быть использована как любая другая ссылка, в частности быть открыта в новой\n вкладке, ее адрес может быть скопирован через контекстное меню и т.д.</p><h5 id=\"packages\" class=\"title\">Пакеты</h5><p>В самом начале, когда я говорил о структуре и организации клиента, я отметил, что одной из наиболее важных задач\n в этом вопросе является декомпозиция клиента на составляющие элементы. Исходя из этого я указал решение в виде <strong>виджетов</strong> - элементов интерфейса, из которых,\n как из конструктора, формриуется весь клиент. Помимо виджетов (представлений) библиотека Muon поддерживает еще один механизм деления\n клиента на составные части. Таким механизмом являются <strong>пакеты</strong>. Суть пакетов сводится к объединению разных виджетов\n в группы исходя из их назначения. С точки зрения пользователя сайта (не разработчика) пакет может отвечать за определенный раздел сайта, такой\n как адмнистрирование контента, связь посетителя сайта со службой поддержки сервиса/интернет магазина, обработка событий социальных сетей и т.д.</p><p>Для веб-разработчика пакет - это способ упорядочить весь набор виджетов и упростить тем самым работу с ними, а также дополнительная возможность повысить\n эффективность коммандной работы над одним проектом. Использование пакетов не являетя обязательным при создании\n одностраничного приложения на базе Muon, в тоже время, как только сложность приложения достигнет определенного порога, разработчик автоматически\n поймет необходимость создания новых пакетов. По этой причине клиент Muon изначально имеет пакетную структуру и включает в себя\n как минимум один пакет, который имеет название <strong>application</strong>.</p><p>В рамках данного раздела мы не будем создавать новых пакетов, ограничившись лишь исходным пакетом <strong>application</strong>.\n Однако из тех соображений, чтобы по мере чтения туториала не возникало слишком много пробелов в понимании работы клиента, а также файловой структуры проекта,\n нам придется уделить пакетной системе немного дополнительного внимания.</p><div style=\"float: left; width: 230px; margin-right: 20px\" class=\"code\"><strong>client/</strong><br/><strong>|| packages/</strong><br/><strong>|--| application/</strong><br/><span>|----| cache/</span><br/><strong>|----| dependency/</strong><br/><span>|------| css/</span><br/><span>|------| js/</span><br/><span>|------| src/</span><br/><strong>|----| views/</strong><br/><span>|------| collection/</span><br/><span>|------| layout/</span><br/><span>|------| model/</span><br/><span>|------| stack/</span><br/><span>|------| widget/</span><br/><span>|----| tr/</span><br/><strong>|----| package.js</strong></div><p>Основные моменты в файловой структуре пакета Вам должны быть более менее ясны. В первую очередь пакеты должны размещаться в директории\n <strong>/client/packages/</strong> в подпапке, имеющей его название (например, <strong>/client/packages/application</strong>, с которой мы уже имели дело, когда добавляли страницы) и содержащей файл <strong>package.js</strong>, который возвращает\n дескриптор пакета. Также Вам уже известна директория <strong>views</strong>, в которой размещается исходный код создаваемых виджетов. Всего в данной\n папке может находится до пяти подпапок, имена которых: <strong>collection</strong>, <strong>layout</strong>,\n <strong>model</strong>, <strong>stack</strong> и <strong>widget</strong> - соовтетствуют пяти объявленным в библиотеке Muon типам\n элементов интерфейса, о которых будет сказано в следующей главе. Также Вам уже известно о существовании папки <strong>application</strong>\n в подпке <strong>stack</strong>, которая соответствует представлению <strong>application_stack</strong>, о котором говорилось\n в предыдущей главе.</p><p>Структура пакета также включает директории <strong>dependencies/js</strong>, <strong>dependencies/css</strong> и <strong>dependencies/src</strong>,\n которые выполняют задачу хранения статичных файлов пакета аналогично тому, как это делает папка <strong>/client/assets</strong> по отношению ко всему приложению.\n Директория <strong>tr</strong> предназначена для хранения данных для интернализации приложения, и, в свою очередь, <strong>cache</strong> хранит в себе скомплированный исходный код\n пакета в целом, используемый для статичной выгрузки его в браузер в production-режиме. Более подробно о том, как использовать все возможности\n пакетов в нашем приложении, мы поговорим в следующих главах.</p><p>Главными задачами, которые решает пакет, являются, как уже говорилось выше, разделение всех виджетов пакета на группы в зависимости от их назначения, а также\n формирование разделов на сайте со своей независимой структурой. Как вы уже знаете, дескриптор пакета <strong>package.js</strong> включает в себя маршруты, по которым допустимы\n переходы на сайте, а сам пакет также может содержать объявление представления <strong>application_stack</strong> и <strong>страниц</strong>, соответствующих этим маршрутам (см. <a data-route='/general/hello_world/pages'>предыдущую главу</a>).\n Помимо этого, пакеты могут ссылаться друг на друга, образую вложенную древовидную структуру маршрутов. Так, например, на данном сайте раздел <a data-hover='.navbar-nav li.active a'>туториал</a>,\n который Вы сейчас читаете, заключен в независимый пакет и имеет собственную внутренню систему маршрутов, которая подключена к пакету <strong>application</strong>,\n по адресу <strong>/tutor</strong>. Проинспектировав в консоли браузера <a data-hover='[data-muon=\"index_widget\"]'>оглавление</a> данного раздела,\n Вы можете увидеть, что все тэги ссылок обладают атрибутом <strong>data-route</strong>, отличающимся от непосредственной ссылки <strong>href</strong>\n отсутствием префикса <strong>/tutor</strong>.</p><p>Когда один пакет ссылается на другой, для соответствующего маршрута - точки подключения пакета - автоматически создается пустая страница, единственным дочерним\n элементом которой является представление <strong>application_stack</strong> подключаемого пакета. Таким образом струткура приложения получается многоуровневой\n и выглядит примерно, как показано ниже:</p><div class=\"tutor-img\"><img data-src=\"complex_app_page_struct.png\"/></div><p>Для того, чтобы указать, что маршрут является точкой входа для другого пакета, переменная <strong>routes</strong>\n должна содержать соответствующее указание в виде атрибута <strong>package</strong></p><pre class=\"prettyprint lang-js\">module.exports = {<br>\n  routes: [<br>\n      ...<br>\n      {<br>\n              route: \"/tutor\"<br>\n              package: \"tutorial\"<br>\n     },<br>\n      ...<br>\n   }<br>\n}<br></pre><p>В принципе, это все, что Вам сейчас необходимо знать о пакетах. Файл-дескриптор пакета содержит помимо маршрутов целый ряд\n параметров, которые выполняют свою роль в процессе работы библиотеки и помогают в процессе сборки приложения. Более\n подробно мы коснемся их в следующих разделах туториала.</p><h5 id=\"widgets\" class=\"title\">Виджеты</h5><p>Мы наконец подошли к основному моменту в разработке клиента - созданию виджетов. Фактически мы уже занимались\n созданием виджетов, когда добавляли новые страницы в клиент. Прежде чем мы продолжим, мне нужно сделать\n несколько замечаний касательно терминологии.</p><p>Формально все, что создано в директории <strong>views</strong> пакета, считается виджетом, включая\n <strong>application_stack</strong> и страницы. В то же время, в предыдущей главе я указал, что в папке <strong>views</strong>\n может находиться лишь пять папок, соответствующих названиям объявленных типов виджетов, среди которых также\n присутствует название <strong>widget</strong>. Слово <strong>view</strong> с английского переводится как <strong>представление</strong>, что общепринято в веб-разработке.\n В тоже время термин <strong>представление</strong> взят из аббревиатуры <a href='http://en.wikipedia.org/wiki/Model_View_Controller' target='new'>MVC (Model, View, Controller)</a>\n и имеет прямое отношение к отображению данных моделей, что не совсем корректно по отношению к элементам интерфейса, так\n некоторые из них не имеют прямого отношения к данным и имеют в большей степени функциональное или структурное назначение,\n например <strong>лэйауты</strong> (<strong>layouts</strong>). Все это может показаться крайне запутанным, и по этой причине, чтобы избавить\n Вас от лишней головной боли в дальнейшем, мы примем несколько соглашений относительно того, что и как называть.</p><ul><li>Собственно, все элементы интерфейса вне зависимости от их назначения в данном туториале я называю <a href='http://en.wikipedia.org/wiki/GUI_widget' target='new'>виджетами</a> или представлениями.</li><li> Среди всех виджетов присутствует пять типов: лэйауты, модели, коллекции, стэки и виджеты. <strong>Тип виджет</strong> - является наиболее общим и самым\n простым типом представлений (все остальные типы обладают функцоналом обычных виджетов).</li><li>Исходный код виджетов (представлений) размещен в директории <strong>views</strong> пакета - это в большей степени дань моде в веб-разрботке.</li><li>В процессе программирования на JavaScript Вы будете создавать виджеты, используя соответствующие классы: <strong>m.View</strong>,\n <strong>m.WidgetView</strong>, <strong>m.LayoutView</strong>, <strong>m.PageLayoutView</strong> и т.д. Сами классы\n наследованы от класса <strong>Backbone.View</strong> библиотеки <a target='new' href='http://backbonejs.org'>Backbone</a>, лежащей в основе Muon, и используют\n аналогичное название.</li></ul><p>Пока мы начнем с разрботки обычных виджетов, так как они несут в себе весь базовый функционал представлений.\n Как мы уже знаем, создание виджетов сводится к созданию соответствующей директории в одной исходных подпапок представлений (в нашем случае\n <strong>/views/widget</strong>) и описанию трех его составляющих: верстки, логики и внешнего вида.</p><div style=\"padding: 0 100px\" class=\"tutor-img\"><img data-src=\"js_css_html.png\"/></div><p>Формально, любая (но не все сразу!) из этих частей может отсутствовать - в этом случае она замещается стандартным элементом:\n в случае верстки - это пустой тэг (по-умолчанию DIV), для логики - это стандартный класс соответствующего типа (например, m.WidgetView),\n стили в данном случае просто отстутствуют.</p><p>Для того, чтобы обращаться к виджетам в процессе создания приложения, требуется какой-то механизм их именования. В Muon\n имя виджета включает в себя две составляющие - непосредственное имя и тип. Непосредственное имя виджета соответствует\n его пути относительно базовой директории, в то время как тип - названию этой директории. Так, например, виджет размещенный в\n директории <strong>/views/widget/widget/super/some/</strong> будет иметь имя <strong>some_super_widget</strong> и тип <strong>widget</strong>.\n Другой пример - директория <strong>/views/layout/page/message/send/</strong> будет соответствовать <strong>layout</strong>-виджету\n с именем <strong>send_message_page</strong>.</p><p>Чтобы в процессе создания виджета мы могли автоматически отслеживать его изменения в браузере, нам необходимо разместить\n его на одной из наших созданных страниц (например, на главной - <strong>index_page_layout</strong>). Для помещения одних виджетов\n в другие библиотека предоставляет несколько различных механизмов, но самый простой из них - это декларация виджета с помощью\n верстки. В частности с помощью такой записи:</p><tag>= \"<div data-widget-view='some_widget' />\"</tag><pre class=\"prettyprint lang-html\"></pre><p>мы можем разместить виджет <strong>some_widget</strong> в любом месте нашего приложения. В процессе формирования (<strong>рендеринга</strong>) каждое представление анализурет\n содержание собственной верстки и размещает в соответствующих тэгах другие представления, что избавляет нас от необходимости\n делать это вручную в JavaScript коде.</p><p>Начнем мы с простого примера - наш виджет будет представлять собой две кнопки, по нажатию одной из которых будет всплывать alert box с\n сообщением \"Hello, world!\", по нажатию второй - виджет сам себя удалит. Для этого на странице <strong>index_page</strong> необходимо добавить тэг аналогично тому,\n как это было сделано выше:</p><p><strong>/client/packages/application/layout/page/index/index.html:</strong></p><title>= \"<h1>Welcome to the Super Calendar</h1>\"</title><data>= \"<p>This is the main page of the Calendar</p>\"</data><widget>= \"<div data-widget-view='alertBox' />\"</widget><pre class=\"prettyprint lang-html\"><br/><br/></pre><p>Перезагрузив страницу, мы не увидим ничего, кроме ошибки в консоли об отсутствующем представлении.\n Исправим это, создав файл с описанием верстки нашего виджета:</p><p><strong>/client/packages/application/widget/alertBox/box.html</strong></p><but>= \"<button id='press'>Press me!</button>\"</but><but_remove>= \"<button id='remove'>Remove me!</button>\"</but_remove><pre class=\"prettyprint lang-html\"><br/></pre><p>Если мы вновь перезагрузим страницу, то увидим на месте, где мы указали блок <strong>DIV</strong> с атрибутом\n <strong>data-widget-view</strong>, кнопки нашего виджета:</p><div class=\"tutor-img shadow\"><img data-src=\"main_page_but_added.png\"/></div><p>Разместить виджет данным образом мы можем в любом месте приложения любое количество раз, библиотека это допускает,\n хотя особого смысла в этом нет.</p><p>Существуют ситуации, когда виджет не предполагает взаимодействия с другими виджетами и не несет в себе какой либо\n функцониальности, кроме пассивного отображения данных верстки (это справедливо, например, для страниц данного туториала).\n Однако, в большинстве случаев Вам всеже потребуется возможность активного взаимодействия виджетов как с пользователем,\n так и друг с другом. Для этого виджет должен обладать определенным функциональным интерфейсом, а также способностью,\n обрабатывать внешние асинхронные события.</p><p>Вполне очевидно, описание программного интерфейса для нашего виджета должно быть помещено в файл <strong>/views/widget/alertBox/box.js</strong>.\n Данный файл должен содержать в себе объвление нового класса виджетов, которое происходит за счет расширения одного из уже существующих классов представлений.\n Так например, для создания нового класса представлений типа \"виджет\" необходимо наследовать уже объявленный класс <strong>m.WidgetView</strong>.\n С учетом того, что язык JavaScript не предусматривает прямого механизма наследования (принятого в общераспространенных объектро-ориентированных языках),\n наследование в данном случае осуществляется через специальных метод <strong>extend</strong>, которым обладают все существующие и вновь создаваемые классы виджетов.\n Выглядеть это должно следующим образом:</p><pre class=\"prettyprint lang-js\"> m.WidgetView.extend({<br>\n      init: function(){ ... },<br>\n      rendered: function(){ ... },<br>\n      events: { ... },<br>\n      removed: function(){ ... },<br>\n });<br></pre><div class=\"mark\"><h5>Muon vs. Backbone</h5><p>Механизм наследования в даном случае перенесен из библиотеки <strong>Backbone</strong>, где для объявления нового типа представления\n также используется метод <strong>Backbone.View.extend</strong>. Общее поведение, присущее представлениям Backbone перенесено с небольшими\n изменениями в библиотеку Muon. В тоже время виджеты Muon реализуют целый комплекс мер, позволяющих лучше контролировать жизненный цикл\n создаваемых экземпляров виджетов, а также совмещать их с другими подсистемами фреймворка. Базовый функционал виджетов, перенесенный в Muon из\n библиотеки Backbone, описан в соответствующей разделе <a target='new' href='http://backbonejs.org/#View'>документации</a></p></div><p>Подробно интерфейс виджетов будет рассмотрен в соответствующих главах туториала, а пока рассмотрим возможность перехвата пользовательских событий\n в нашем <strong>AlertBox</strong>'е. За объявление обработчиков событий (вне зависиомости от типа), отвечает атрибут <strong>events</strong>.\n Он представлят из себя объект (словарь), ключом которого является указание события и селектор, по отношению к которому это событие применяется.\n Значением данного атрибута является либо непосредственно метод, его обрабатывающий, либо имя метода, принадлежащего данному виджету.\n В нашем случае описание виджета будет выглядеть следующим образом:</p><p><strong>/client/packages/applciation/views/widget/alertBox/box.js</strong></p><pre class=\"prettyprint lang-js\"> m.WidgetView.extend({<br>\n      events: {<br>\n          \"click button#press\" : function(){ alert(\"Hello, World!\"); },<br>\n          \"click button#remove\" : \"remove\"<br>\n      }<br>\n });<br></pre><p>Вновь перезагрузив страницу, мы можем опробовать наш виджет: по нажатию на кнопку с надписью 'Press Me!' должно появиться alert уведомление.</p><div class=\"tutor-img shadow\"><img data-src=\"alert_popup.png\"/></div><p>Нажав на кнопку с надписью 'Remove Me' оба тэга <strong>button</strong> будут удалены из документа.</p><p>Напоследок следует сказать, что путем регистрации событий через атрибут <strong>events</strong>, можно перехватывать\n произвольные события, в том числе не являющиеся <strong>DOM</strong>. Реализация обработки событий в Muon\n происходит с помощью средств библиотеки <a target='new' href='http://jquery.com'>jQuery</a>, с который должно быть знакомо\n подавляющее большинство JavaScript-программистов. По этой причине виджеты имеют возможность обрабатывать как стандартные события\n браузера, так и нестандартные пользовательские события, в том числе испускаемые другими виджетами. О том как их использовать мы поговорим в следующих главах.</p><p>На данном этапе мы приостановим наше знакомство с виджетами и работой клиента в целом. Следующим шагом для нас будет работа с пользовательскими\n данными через виджеты моделей данных и коллекций, а также взаимодействие с сервером. Но, прежде чем преступить к этому этапу, нам необходимо\n познакомиться с основными принципами работы сервера, а также протоколом взаимодействия сервера и клиента.</p><h4 id=\"server\" class=\"title\">Наполнение сервера</h4><p>В общем случае одностраничное приложение может работать без участия удаленного сервера - современные браузеры\n для целей хранения данных предоставляют целый ряд средств, таких как работа в оффлайн режиме и кэширование,\n поддержка LocalStorage и WebSQL и т.д. Более того, возможен вариант, когда вся логика приложения размещена в\n одном единственном HTML файле, его мы рассмотрим, когда будем разбираться с разработкой приложений для мобильных платформ.\n И все же, в большинстве случаев ответственность за хранение пользовательских данных на себе несет веб-сервер. В тех\n же случаях, когда одни и те же данные должны быть доступны нескольким авторизованным клиентам одновременно,\n обойтись без его участия невозможно впринципе.</p><p>В настоящее время существует немало различных серверных фреймворков, позволяющих очень гибко выполнять обработку запросов произвольного\n типа и возвращать при этом ответ в произвольном формате, и даже осуществлять асинхронные уведомления\n клиентов о происходящих на сервере изменениях в данных (например, с помощью WebSockets). Однако большинство\n таких фреймворков рассчитано на классический режим работы сайта, когда подавляющая часть запросов поражадает HTML-ответ и, реже, JSON-данные для AJAX.\n Как правило, система маршрутов (предполагаемых пользовательских кейсов) для сайтов, созданных на базе подобных фреймворков, задается на стороне сервера,\n что приводит к необходимости активного участия сервера в процессе работы клиента и, как следствие, выполнения\n большого количества повторов одних и тех же операций. Для целей поддержки работы одностраничных приложений подобный функцониал во\n многом оказывается избыточным. Безусловно, любая серверная библиотека может относительно легко быть адаптирована для работы в\n качестве простого API-сервера, который необходим для работы SPA, однако, в большинстве случаев и с высокой вероятностью\n средства, представленные подобными фреймворками, окажутся невостребованы и будут выполнять роль баласта, потребляя лишние ресурсы процессора и памяти.</p><p>Серверная составляющая фреймворка Muon предназначена для решения задач, напрямую связанных с особенностями построения одностраничных веб-приложений, и\n реализует все инструменты, поддерживающие работу клиентской части библиотеки. В первую очередь к ним относится обработка атомарных запросов, позволяющих\n клиенту поддерживать актуальность данных в процессе своей работы. В данной главе мы достаточно поверхностно коснемся базовых возможностей\n по управлению данными на стороне сервера. Более подробная информация об организации Muon сервера и его возможностях доступна в соответствующем <a data-route='/server'>туториале</a>.</p><h5 id=\"MVC\" class=\"title\">MVC</h5><p>Начиная разговор о работе сервера нельзя не затронуть описание механизма, которому полностью подчинена его работа.\n Даже несмотря на то что пока нам предстоит лишь создать несколько сущностей данных и показать, как происходит\n базовое клиент-серверное взаимодействие, не лишним будет иметь представление о том, из чего складывается общая логика сервера.</p><p>В основе сервера Muon лежит структурный шаблон <a href='http://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller' target='new'>MVC</a> (Model, View, Controller - Модель, Представление, Контроллер), который\n очень популярен и активно используется в веб-программировании. Те, кто знаком с ним знаком, могут сразу перейти\n к следующей главе, для остальных же, я далее постараюсь кратко описать содержание данного шаблона, а также указать\n основные нюансы его реализации в библиотеке.</p><p><strong>MVC</strong> - это структурный шаблон, определяющий способ организации программного кода и выделяющий три основных структурных паттерна\n в составе приложения: <strong>модель</strong>, <strong>представление</strong> и <strong>контроллер</strong>. Как обычно бывает в случае с распространенными\n парадигмами программирования, существует несколько интерпретаций относительного того, за что отвечает каждая из букв в аббревиатуре (это особенно\n характерно для веба). Однако, в большинстве случаев распределение обязанностей между данными паттернами оказывается следующим:</p><ul><li><strong>Модели</strong> - составляющая, которая реализует в себе суть и бизнес логику приложения,\n определяет его содержательную часть, к которой в первую очередь относятся типы данных (пользовательские классы) и их взаимные ассоциации. Помимо этого\n модель может включать в себя указания, как именно она должна реагировать на внешние воздействия (в нашем случае входящие HTTP-запросы) и\n и как они могут влиять на состояние системы.</li><li><strong>Преставления</strong> - решают задачу визуализации данных моделей для того, чтобы пользователи приложения\n (в том числе другие програмы) могли адекватно интерпретировать состояние моделей данных, а также\n через <strong>контроллер</strong> или другие <strong>преставления</strong> менять его. Визуализация данных в данном случае не означает обязательное использование\n графики и/или пользовательского интерфейса (в обычном понимании), в данном случае правильнее было бы говорить о формате данных, пригодном\n для восприятия пользователями приложения. Например, в случае, когда с приложением или сервисом взаимодействует программный бот, в качестве\n такого формата может выступать JSON, YAML или XML, для пользователя веб-сайта, таким форматом как правило является HTML.</li><li><strong>Контроллер</strong> принято считать промежуточным звеном между моделью и ее представлением, а также пользователем и моделью. С точки зрения\n <a href='http://st-www.cs.illinois.edu/users/smarch/st-docs/mvc.html' target='new'>исходного определения MVC</a>, котороллер выступает в роли\n интерпретатора запросов со стороны пользователя, преобразуя их в соответствующие команды моделей данных, с учетом текущего состояния моделей,\n прав доступа пользователя, а также других условий, способных повлиять на результат запроса.\n Помимо этого контроллер может поддерживать актуальность представлений за счет синхронизации состояния моделей данных с соответствующими\n данными представлений.</li></ul><div style=\"padding: 0px 200px;\" class=\"tutor-img\"><img data-src=\"MVC-Process.png\"/></div><p>Как я уже упоминал выше, в реальности далеко не всегда при проектировании веб-приложений придерживаются чистого определения MVC.\n Чаще всего под моделью во многих веб-фреймворках понимают объявленные типы данных и их взимосвязи, которые в большинстве случаев\n прямо или косвенно отображаются в структуру базы данных. Под контроллером же понимают механизм роутинга - соотнесения\n пользовательских HTTP-запросов с действиями (экшенами - actions), осуществляющими манипулирование моделью, которые также входят в\n состав контроллера. Результатом работы экшена обычно является вывод HTML, который отражает текущее состояние всей модели (или всех моделей, кому как нравится)\n и таким образом формирует представление.</p><p>Бытует мнение, с которым я полностью согласен, что данная интерпетация MVC является неверной, и в первую очередь потому\n что при таком раскладе бизнес логика приложения реализуется не в модели, а в контроллерах (экшенах), таким образом контроллер и модель оказываются неразрывно связаны (или точнее, модель без контроллера\n становится неполноценной), чего конечно же быть не должно. Однако, именно такой подход к организации кода оказывается наиболее естественен\n (или, возможно, привычен) для веба, так как исторически сложилось, что для каждого типа запроса (маршрута) существует некий метод (контроллер),\n который выполняет всю кухню его обработки (главным образом взаимодействие с СУБД, моделью) и формирует итоговый HTML-ответ (представление). Современные библиотеки\n позволяют значительно оптимизировать этот процесс, оставляя за экшенами лишь наиболее специфичный для запроса функционал, вынося все наиболее рутинные\n и повторяющиеся от запроса к запросу операции в периферийные методы (например, middleware). Тем не менее суть и распределение обязанностей в структуре MVC-сохраняется.\n В целом это не имеет определяющей роли при построении приложения, так как во многом остается вопросом терминологии, в то время как главной\n задачей любого фреймворка является обеспечение наиболее четкой и прозрачной структуры кода, максимально следующей DRY-парадигме (Don't Repeat Yourself - не повтояйся),\n с чем современные фреймворки справляются более чем успешно. Также надо понимать, что изначально идея MVC была сформулирована в далеком 79-м\n по отношению к настольным приложениям с оконными интерфейсами на языке Smalltalk, где взаимодействие моделей и представлений (через контроллер)\n значительно отличается от взаимодействия браузера и сервера.</p><p>Серверная часть фреймворка Muon также реализует MVC-структуру, и также как и во многих других MVC-фреймворках, бизнеслогика приложения заключена как в модели,\n так и в экшенах контроллера. Однако на этом сходство Muon-сервера с классическими фреймворками заканчивается. Как я уже говорил выше, Muon представляет собой API-сервер,\n который позволяет клиенту манипулировать данными на сервере, а также поддерживать их актуальность на своей стороне. Происходит это за счет\n отправки атомарных AJAX-запросов (один запрос связан с одним из возможных экшенов для конкретной модели данных), при этом для доступа к данным используется автоматически\n формируемый API, который учитывает имена моделей, вызываемых экшенов и их взаимные ассоциации. То, как это работает и как это использовать\n мы рассмотрим в следующих трех главах.</p><h5 id=\"models\" class=\"title\">Модели данных</h5><p>Описание сути MVC в предыдущей главе было достаточно абстрактным, и, чтобы исправить это и лучше понять принцип работы данной парадигмы,\n нам следует взять несколько примеров из жизни, что мы сейчас и сделаем в рамках нашего календаря.</p><p>Исходя из существующего определения <strong>модели</strong> следует, что одной из главных предназначений этого паттерна является построение системы понятий, применимых к той области,\n в которой предполагается работа приложения. Существует несколько техник, позволяющих достаточно легко определить, какие именно понятия и, соответственно, модели должны\n быть включены в состав проекта. Одним из наиболее популярных и эффективных способов, например, является сочинение историй, описывающих некоторую ситуацию или кейс\n (usecase) - вариант использования приложения. В данной главе и в туториале в целом описывать истории использования мы не станем, однако, этому вопросу я рекомендую уделить\n особое внимание, так как умение проводить грамотный анализ предметной области неплохо помогает при проектировании любых программных систем (не только веб-приложений).\n Помочь лучше разобраться в этой теме Вам поможет замечательная <a href='http://www.amazon.com/Object-Oriented-Analysis-Design-Applications-Edition/dp/020189551X' target='new'>книга</a>\n Гради Буча, одного из авторов языка UML.</p><p>Я думаю, вполне очевидно, что в качестве моделей данных нам необходимо определить такие понятия как <strong>заметка</strong> и <strong>пользователь</strong>. Заметки мы будем включать в наш календарь\n для конкретных дат и составлять из них расписание на день. В свою очередь \"пользователь\" будет выступать той абстракцией, которая позволит нам разделять заметки,\n созданные различными клиентами. В данном случае мы не будем воссоздавать сложную логику классического пользователя веб-сервиса с необходимой регистрацией, сессиями и т.д.,\n и ограничимся лишь выделением уникальных пользователей и присваиванием им уникального ID с помощью Cookie.</p><p>Создание новой модели данных в Muon происходит отличным от большинства других фреймворков способом. Как правило определение моделей данных (ровно как контроллеров и т.д.)\n происходит путем наследования общего класса моделей, либо одного из существующих его производных, например:</p><pre class=\"prettyprint lang-js\"> > var NewModel = SuperModel.<strong>extend</strong>({ ... });</pre><p>Напротив, большинство сущностей в Muon определяется не через прямое выполнение кода (определение нового класса через наследование), а с помощью дескрипторов,\n помещенных в определенные участки файловой структуры проекта. Вы уже знаете, что в рамках дерева проекта существует директория <strong>/server/app/models</strong>.\n Данная директория предназначена для размещения в ней файлов - JavaScript модулей, которые подключаются к проекту в процессе ее инспектирования библиотекой\n (аналогичным образом работают все составляющие сервера). При этом имена и размещение файлов относительно данной директории имеет центральное значение в процессе\n именования моделей, аналогично тому как это было в случае с виджетами. В силу того, что модель формируется не явно при наследовании класса, а на основе описания,\n файл с дескриптором может быть пустым (экспортирование пустого JavaScript-модуля вернет пустой объект). Поэтому для объявления наших двух моделей нам пока достаточно\n создать два файла:</p><ul><li>/server/app/models/note.js</li><li>/server/app/models/user.js</li></ul><p>Чтобы проверить работу модели мы можем воспользоваться предоставляемым Muon сервером <strong>веб API</strong>, либо обратиться к средствам библиотеки через интерпретатор.\n Работу с веб API мы оставим до следующей главы, а пока воспользуемся классическим методом отладки веб-проектов и попытаемся вручную поработать с моделями данных\n с помощью <strong>node</strong>-интерпретатора. Вызов интерпретатора можно выполнить напрямую с помощью команды <strong>node</strong>, либо воспользовавшись утилитой <strong>m-console</strong>, входящей в состав\n библиотеки. <strong>m-console</strong> является небольшой надстройкой над базовым интерпретатором и лишь добавляет в него автоматическую загрузку окружения проекта Muon из\n текущей директории командной строки.</p><div class=\"mark\"><h6>Модели данных и СУБД</h6><p>В данном туториале мы почти не будем говорить о базе данных, так как пока разбираем наиболее общие моменты библиотеки, не вдаваясь в технические детали ее реализации.\n В разделе, посвященном окружению, в главе <a data-route='/general/env/db'>База данных</a> я указал на использование <strong>MongoDB</strong> в качестве основной базы данных.\n Безусловно, в реальных проектах Mongo далеко не всегда оказывается эффективным решением, в конечном счете необходимость использования другой СУБД может оказаться требование заказчика.\n В качестве основы для моделей Muon сервера используется библиотека <a target='new' href='https://github.com/dresende/node-orm2'>node-orm2</a>, поддерживающая работу нескольких наиболее\n популярных СУБД, в том числе PostrgreSQL и MySQL. Вы можете обратиться к <a target='new' href='https://github.com/dresende/node-orm2/wiki'>документации</a> данного ORM,\n чтобы разобраться с особенностями его работы. Однако, здесь и далее в рамках туториала я настоятельно рекомендую использовать MongoDB, так как это значительно упростит\n процесс знакомства с библиотекой. Если Вы правильно настроили базу данных и не меняли конфигурационные файлы проекта, создаваемые в проекте модели будут автоматически отображаться\n на текущую используемую базу данных.</p></div><p>Серверная часть Muon определяет единственную глобальную переменную <strong>m</strong>, которая доступна в любом месте в рамках проекта. <strong>m</strong> является простым объектом, включающим в себя\n набор членов, ссылающихся на различные структурные элементы сервера. В текущий момент нас интересует атрибут <strong>models</strong>, который, как можно догадаться,\n содержат в себе перечень объявленных моделей:</p><pre class=\"prettyprint lang-js\">foo$ m-console<br>\n > <strong>m.utils._.keys(m.models)</strong><br>\n [\"note\",\"user\"]<br>\n > <strong>m.models[\"note\"]</strong><br>\n { [Function]<br>\n     allProperties:<br>\n     { created_at:<br>\n         { type: 'date',<br>\n           time: true,<br>\n           klass: 'primary' },<br>\n       modified_at:<br>\n           { type: 'date',<br>\n               time: true,<br>\n               klass: 'primary' },<br>\n       _id:<br>\n           { type: 'serial',<br>\n               rational: 'false',<br>\n               key: true,<br>\n               klass: 'key' } },<br>\n ...</pre><p>Muon как и любой другой Node.js проект обладает рядом зависимостей, среди которых есть библиотека <a target='new' href='http://underscorejs.org'>underscore</a>.\n Для того, чтобы упростить доступ к наиболее востребованным функциям данной библиотеки, она была включена в состав переменной <strong>utils</strong> корневого объекта <strong>m</strong>.\n Так с ее помощью в первой команде <strong>m.utils._.keys(m.models)</strong> мы формируем массив ключей переменной объекта <strong>m.models</strong>. Вывод следующей команды указывает\n на содержание модели <strong>note</strong>, и в частности на переменную <strong>allProperties</strong>, которая хранит перечень объявленных атрибутов модели. Не смотря на то, что файл с\n дескриптором модели заметок остался незаполненным, можно видеть, что модель уже в начальном состоянии включает несколько исходных служебных атрибутов:</p><ul><li><strong>_id</strong> - уникальный идентификатор объекта модели, стандартный общепринятый атрибут всех записей баз данных;</li><li><strong>created_at</strong> - атрибут временная метка, ссылающаяся на момент первого сохранения модели в БД, неизменяемая в течение всего времени жизни объекта;</li><li><strong>modified_at</strong> - атрибут временная метка, ссылающаяся на момент последней модификации объекта модели, устанавливается автоматически непосредственно перед сохранением модели в базу данных.</li></ul><p>Создать новый экземпляр модели заметки можно, вызвав метод <strong>create</strong соответствующего класса:</p><pre class=\"prettyprint lang-js\"> > var Note = m.models.note;<br>\n > var n1 = Note.create();<br>\n > n1<br>\n { created_at: [Getter/Setter],<br>\n     modified_at: [Getter/Setter],<br>\n     _id: [Getter/Setter],<br>\n > n1.created_at<br>\n null<br>\n > n1.save()<br>\n ...<br>\n > n1.created_at<br>\n Thu Jan 28 2014 15:34:07 GMT+0400 (MSK)<br>\n > n1._id<br>\n '52e0fe2ff75974be11de9427'<br></pre><p>Из вывода видно, как после вызова созданного экземпляра модели ему был присвоен атрибут <strong>_id</strong>, который имеет формат стандартного объекта <strong>ObjectId</strong> MongoDB.</p><div class=\"mark\"><h6>Model vs. ORM</h6><p>Формально, то что мы называем моделью на стороне сервера является лишь прослойкой между интерпретатором и базой данных, позволяющей с помощью унифицированных\n команд контролировать содержание соответствующей коллекции (таблицы) в базе, а также преобразовывать табличную (реляционную) форму записей в объектную\n (естественную для JavaScript). Последнее относится к случаю с использованием SQL-баз, и соответствующий механизм называется <strong>ORM</strong> (<strong>Object-Relational Mapping</strong>,\n в случае для NoSQL баз - <strong>ODM</strong>, <strong>Object-Document Mapping</strong>). Модели Muon реализованы на базе ORM/ODM (далее везде ORM) библиотеки\n <a target='new' href='https://github.com/dresende/node-orm2'>node-orm2</a>, которая предоставляет набор методов для доступа к записям из БД и их фильтрации.</p></div><p>Для работы с объектами моделей соответствующие классы предоставляют целый ряд методов, таких как <strong>find</strong>, <strong>get</strong>, <strong>filter</strong>, <strong>sort</strong>, <strong>limit</strong> и т.д.\n Так например, чтобы получить список всех доступных объектов заметок, следует выполнить следующую команду:</p><pre class=\"prettyprint lang-js\"> > m.models.note.find({},function(err,arr){<br>\n ...  console.log(JSON.stringify(arr));<br>\n ... });<br>\n [{<br>\n     \"created_at\":\"2014-01-28T15:34:07.651Z\",<br>\n     \"modified_at\":\"2014-01-28T15:34:07.651Z\",<br>\n     \"_id\":\"52e0fe2ff75974be11de9427\",<br>\n  }]</pre><p>Все эти методы в большинстве своем работают, используя классический механизм обратных вызовов (callback), где колбэк-метод передается\n в качестве последнего аргумента и сам принимает два параметра: объект ошибки и результат.</p><p>Любая модель (как и любой пользовательский класс) характеризуется набором описывающих ее атрибутов, а также взаимных ассоциаций. Наш случай\n достаточно прост, поэтому мы сразу можем принять, что модель <strong>заметки</strong> будет включать в себя заголовок, текст и временной штамп,\n а также будет ссылаться на пользователя, создавшего данную заметку. Модель пользователя будет характеризоваться единственным атрибутом -\n ключом доступа, который будет сохранен в Cookie-переменной на стороне клиента.</p><div style=\"padding: 0 150px\" class=\"tutor-img\"><img data-src=\"model_relations.png\"/></div><p>Указать на наличие всех перечисленных выше аттрибутов у наших моделей можно, отредактировав файлы дескрипторы:</p><p><strong>/server/app/models/note.js</strong></p><pre class=\"prettyprint lang-js\"> module.exports = {<br>\n      attributes: {<br>\n          title: \"text\",<br>\n          text: \"text\",<br>\n          timestamp: \"data\"<br>\n      },<br>\n      hasOne: {<br>\n          user: \"user\"<br>\n      }<br>\n  };</pre><p><strong>/server/app/models/user.js</strong></p><pre class=\"prettyprint lang-js\"> module.exports = {<br>\n      attributes: {<br>\n          accessId: \"text\",<br>\n      }<br>\n };</pre><div class=\"mark\"><h6>Перезагрузка сервера</h6><p>Для того, чтобы внесеные в файлы-дескрипторы изменения были учтены сервером, можно перезапустить консоль, однако проще и быстрее добиться этого можно, вызвав\n метод <strong>reload</strong>. Метод принимает один или два аргумента: перывй (опциональный) - новые параметры сервера, второй - асинхронный колбэк метод\n который вызовется, когда сервер будет полностью перезагружен. Следует учитывать, что классы моделей (m.models.note и т.д.) будут перезаписаны с учетом внесенных\n изменений.</p></div><p>Описание атрибутов должно находиться в переменной <strong>attributes</strong>, которая представляет собой либо словарь <strong>имя:тип&nbsp</strong> (простая форма),\n либо объект с описанием памаметров <strong>имя:дескриптор</strong> (сложная форма). В случае сложной формы дескриптор также должен содержать указания о типе\n атрибута. Под <strong>типом</strong> атрибута понимается не встроенный тип переменных JavaScript, а тип определенный <strong>ORM</strong>, который однозначно соответствует\n типу данных СУБД. ORM поддерживает следующие типы атрибутов:</p><ul><li><strong>text</strong> - текстовый тип;</li><li><strong>number</strong> - тип чисел;</li><li><strong>boolean</strong> - бинарный тип (значения <strong>true</strong>/<strong>false</strong>);</li><li><strong>date</strong> - временной тип (таймштамп - дата и время);</li><li><strong>enum</strong> - перечисляемый тип (конечное множество);</li><li><strong>object</strong> - объект в JSON-формате;</li><li><strong>binary</strong> - тип бинарных данных.</li></ul><p>Также разработчик имеет возможность определять собственные типы атрибутов на базе уже существующих. Этой темы мы коснемся в туториале с подробным описанием возможностей сервера.</p><p>Ассоциации в моделях Muon отделены от непосредственных атрибутов и описываются в переменных <strong>hasOne</strong> и <strong>hasMany</strong>. <strong>hasOne</strong> переменная\n отвечает за ассоциации типа <strong>one2many</strong> (<strong>has&nbsp;one</strong> - владеет или <strong>belongs&nbsp;to</strong> - принадлежит). В нашем случае заметка связана с пользователем через отношение\n <strong>belongs&nbsp;to</strong> (<strong>принадлежит</strong>). Описание ассоциации аналогично описанию атрибутов может быть выполнено в простой или сложной форме. Однако, вместо\n типов данных ORM здесь указываются имена моделей, с которыми определяется связь. Управление ассоциациями для конкретного объекта происходит с помощью методов <strong>set</strong> и <strong>get</strong>,\n (в нашем случае <strong>setUser</strong> и <strong>getUser</strong>). После перезагрузки консоли мы сможем выполнить следующие команды:</p><pre class=\"prettyprint lang-js\"> > m.reload();<br>\n > var n1 = new m.models.note();<br>\n > n1.save();<br>\n ...<br>\n > var u1 = new m.models.user();<br>\n > u1.save();<br>\n ...<br>\n > n1.setUser(u1,console.log);<br>\n ...<br>\n > n1.getUser(function(err,a){<br>\n  ... console.log(a._id);<br>\n  ... });<br>\n '52e9351a6ff047232cd929ef'<br></pre><p>Отношения между моделями допускают ряд опций, в частности ассоциации могут быть взаимными, образующими (существование объекта, без привязки в рамках ассоциации невозможно), множественными (отношения many2many)\n и условными. Особенности таких ассоциаций мы рассмотрим позже, а тех знаний, что мы имеем сейчас, вполне достаточно, чтобы продолжить работу над календарем.</p><h5 id=\"actions\" class=\"title\"> Поведение моделей</h5><p>Методы моделей, такие как <strong>filter</strong>, <strong>one</strong>, <strong>count</strong>, описанные выше, позволяют оперировать объектами моделей на уровне ORM, в частности выполнять простейшие операции, связанные с созданием, удалением и поиском моделей.\n Эти методы универсальны и безотносительны к содержанию модели и в общем случае не связаны с бизнес логикой приложения. Поведение моделей и бизнес логику приложений определяют так называемые \"действия\" или \"экшены\" (actions), входящие\n в состав контроллеров моделей. Действие опредяляет абстрактный (пользовательский) уровень поведения модели, может быть связано с публикацией некого ресурса (модели, например, заметки или фотографии) в социальных сетях, выполнения каких либо расчетов и математических операций связанных с ресуром (финансовым инструментом) и т.д.</p><h5 id=\"apis\" class=\"title\">Сервер API</h5><h5 id=\"data_manipulation\" class=\"title\">Работа с данными на клиенте</h5></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='env_general_chapter_widget_template'><h3 class=\"title\">Окружение</h3><p>Прежде чем начать обсуждение особенностей самой библиотеки, следует обозначить среду обитания и ограничения, в которых\n мы будем вынуждены существовать. Это в первую очередь касается операционной системы, и сопутствующих фреймворку\n языка программирования, его интерпретатора и используемой базы данных.</p><h4 id=\"lang\" class=\"title\">Язык программирования</h4><p>Выбор языка всегда был одним их самых животрепещущих вопросов для большинства программистов,\n способных вызывать бурные споры на форумах и в комментариях блогов и хабра.\n Очевидно, что выбор языка при создании фреймворка имеет первостепенное\n значение. Язык во многом задает тон и стиль, в котором будет вестись разработка как самого фреймворка, так и приложений\n на его основе. От него зависит аудитория разработчиков, так как у любого языка всегда были, есть и будут и фаны, и\n ненавистники. Но, что самое важное, язык определяет будущую экосистему фреймворка в виде сторонних библиотек,\n модулей и методов их распространения, сообщества, документации и т.д. (в этом смысле пример<a href=\"http://ru.wikipedia.org/wiki/Ruby_on_rails\"> Ruby on Rails</a> - показателен).\n Если же рассматривать проблему выбора относительно конечного разработчика, то, думаю, тут большинство опытных программистов\n со мной согласится, в каждом отдельном случае выбор языка - это дело вкуса (или привычки) и целесообразности.</p><p>Если не брать в расчет вкусовщину, из-за которой до сих пор нередко вознкают холивары, то в сухом остатке получим, что\n к основным критериям при выборе языка следует отнести его окружение или экосистему, а также пригодность  для решения\n поставленной задачи.</p><p>Уже из названия библиотеки понятно, что программировать мы будет на<b> JavaScript</b>'е. Я не буду сравнивать его здесь с другими языками программирования, в Интернете существует немало ресурсов\n посвященных данному вопросу. Сразу отмечу, что в случае с одностраничными сайтами мы на ряду с серверным\n программированием будем иметь полноценное<b> клиентское</b> программирование. Более того объем клиентского JavaScript'а\n будет едва ли не больше кода на сервере. Объясняется это главным обазом тем, что подавляющую часть кода сервера,\n мы постараемся привести к паттернам, в то время как вся бизнес-логика Вашего приложения будет вынесена в\n толстый клиент. Более подробно это будет освещено в следующих главах.</p><p>Когда-то при создании Rails разработчики попытались определить единый и универсальный язык программирования, который\n использовался бы для разрботки как на стороне сервера, так и на стороне клиента, а также в процессе верстки.\n В R'o'R этим языком является, само собой, Ruby. Саму по себе идею единого языка, я считаю весьма неплохой, но\n (являясь фанатом JS =) в реализации Rails вижу определенные изъяны. Ключевая проблема здесь, как мне кажется, кроется\n в попытке заменить естественный для браузера JS на набор хэлперов, написанных на Ruby, решающих, как правило, шаблонные\n задачи. К счастью, время, когда JavaScript отвечал за банальное \"всплытие менюшек\" уже давно прошло, и сейчас JS - это\n полносильный язык программирования, весьма удачно подходящий для решения сложных асинхронных задач, к коим относятся взаимодействие\n c пользователем и сетью. В тоже время, JavaScript уже не первый год благодаря<a href=\"http://nodejs.org\" target=\"new\"> Node.js</a> успешно эксплуатируется на сервере. Таким образом, если опустить некоторое количество нюансов, о которых мы поговорим\n позже, JavaScript может оказаться неплохим кандидатом на роль \"того самого\" языка.</p><p>На самом деле я неспроста упомянул Ruby on Rails - объективно, это один из самых успешных и эффективных веб-фреймворков\n из тех, что были созданы за все время, и по этой причине я периодически буду на него\n ссылаться. Сразу скажу, что для любителей Ruby-like синтаксиса есть возможность использовать вместо JS код на&nbsp;<a href=\"http://coffeescript.org/\" target=\"new\">CoffeeScript</a>, к которому я сам периодически прибегаю, так как он в значительной степени способствует написанию \"правильного\"\n кода и имеет множество различных синтаксических \"пряников\". Помимо самого кода, также как и в других фреймворках,\n нам придется создавть HTML-шаблоны, отвечающие за динамическое отображение данных на стороне клиента. Для этих\n целей в настоящий момент существует значительное число языков-шаблонизаторов. Однако, особое внимание я уделю языку&nbsp;<a href=\"http://jade-lang.com/\" target=\"new\">Jade</a>, который был создан по аналогии с языком HAML, используемом в Rails.</p><p>Собственно, на этом обзор инструмента, с помощью которого мы будем творить, я закончу. Уверен, что\n львиная доля читателей данного туториала имеет достаточно хорошее представление о данном языке и его особенностях.\n В том случае же, если Вы не знаете JavaScript, то я настоятельно рекомендую Вам обратиться к соответствующей литературе\n (например, к&nbsp;<a href=\"http://www.ozon.ru/context/detail/id/6118760/\">этой</a>) и/или материалам в Интернете, среди которых особено рекомендую замечательный сайт&nbsp;<a href=\"http://w3schools.com\">W3Schools</a></p><h4 id=\"interpreter\" class=\"title\">Интерпретатор</h4><p>Итак, мы обозначили, что основным языком программирования для нас будет JavaScript, и в роли его интерпретатора,\n а по совместительству и веб-сервера выступает Node.js.</p><h4 id=\"os\" class=\"title\">Операционная система</h4><p>В общем случае выбор ОС, под которой будет вестись работа, - это личное дело каждого разработчика. Для случая с\n JavaScript и Node.js (да и для большинства других сред), всегда существует возможность установить интерпретатор\n и все сопутствующие программы и библиотеки через подготовленные инсталяторы и архивы, которые вы можете скачать на\n сайтах проекта (об этом далее). Каких либо существенных различий в разработке под Windows, Mac или Linux с точки зрения\n Node.js API и дополнительных модулей мне не известно. Исключение составляют лишь модули, которые имеют непосредственную\n зависимость от сторонних программ (например,&nbsp;<a href=\"https://github.com/hacksparrow/node-easyimage\" target=\"new\">EasyImage</a> - модуль работы и изображениями). Таким образом особо значимых объективных приоритетов ни у одной из платформ я не вижу.</p><p>Мои личные пристрастия и опыт склоняют меня в сторону Linux и Mac, так как в моем понимании данные платформы в значительной\n степени ориентированы на разработку, нежели Windows (одна консоль чего стоит). Помимо этого, во многих случаях намного проще\n (привычнее) запускать и контроллировать демонизированные процессы классическими nix-средствами.\n Сразу оговорюсь, в данном случае я говорю о выборе ОС с точки зрения разработки, а не запуска веб-проекта\n в production mode - этой теме будет посвещена отдельная глава туториала. Здесь и далее я буду предполагать, что\n разработка ведется под ОС Ubuntu Linux 12.04 или новее. Для случая с MacOS все действия, связанные с управлением проекта, должны протекать полностью\n идентично Linux. Если же вы выбрали ОС Windows, то при возникновении каких либо трудностей, с большой долей\n вероятности вам поможет волшебная связка&nbsp;<a href=\"http://google.com\" target=\"new\">Google</a>&nbsp;->&nbsp;<a href=\"http://stackoverflow.com\" target=\"new\">StackOverflow.</a></p><h4 id=\"db\" class=\"title\">База данных</h4><p>В качестве базы данных в рамках данного проекта мы будем использовать MongoDB, и я объясню почему.\n Очевидно, база данных является самым распространенным способом хранить данные проекта. Все фреймворки, с\n которыми мне доводилось встречаться, используют ORM (Object-Relational Model), позволяющий прозрачно\n менять представление данных с табличного (в данном случае мы говорим об SQL-базах) в более естественное для разрботки\n - объектное с корректной типизацией. При этом ORM-прослойка, как правило, выполняет целый комплекс задач, по настройке\n индексации, реализации автоматического связывания таблиц для зависимых моделей данных и т.д.\n Когда я начинал работу над Muon.js, я не ставил перед собой цели обеспечить полноценную и всестороннюю работу по\n хранению и выборке данных, на какую способны многие современные СУБД. Главным приоритетом при выборе БД\n была возможность с минимальными затратами обеспечить хранение данных в объектной форме.\n В этом смысле использование NoSQL базы я считаю весьма эффективным и невероятно гибким решением.</p><p>Главным преимуществом работы с MongoDB я вижу возможность на лету менять конфигрукцию (структуру данных) без необходимости\n выполнения миграций, что значительно экономит время и нервы, когда Вы еще не готовы дать подоброное описание\n моделям данных, с которыми собираетесь работать, и хотите составить макет поекта. В дальнейшем вы увидете,\n насколько это свойство упрощает процесс разработки API Вашего проекта.</p><p>Безусловно у NoSQL баз есть свои недостатки. Одним из наиболее значимых является сложность выполнения многоуровневых выборок,\n которые в SQL базах разрешаются обычным вложенным \"селектом\", что приводит к необходимости выполнять несколько запросов\n на выборку и значительно снижает производительность сервера. Решается данная проблема либо уходом в SQL, либо использованием\n процедур на стороне сервера базы данных. Более подробно данный вопрос будет освещен в соответствующих главах.</p><h4 id=\"ide\" class=\"title\">Интегрированная среда разработки</h4><p>Несомненно, для многих начинающих программистов выбор IDE является одним из краеугольных вопросов. Это неудивительно,\n так как именно удобство разработки формирует общее впечатление о данном процессее, помогает с его организацией,\n часто упрощает работу с системами контроля версий и т.д. Разработка конечно же может вестись абсолютно любыми\n средствами, включая стандартный блокнот и консоль. Достаточно часто мне лично приходится прибегать к работе с\n файлами проекта на удаленном сервере через SSH соединение в консоли под&nbsp;<a href=\"http://www.vim.org/\" target=\"new\">Vim</a>, что совсвем неплохо, когда ты знаком с системой комманд данного редактора.</p><p>Среди существующих развитых IDE могу порекомендовать&nbsp;<a href=\"http://aptana.com\" target=\"new\">Aptana</a>, которая является полностью бесплатной и имеет огромный перечень расширений, доступных ей по наследству от Eclipse.\n Ко всему, когда речь зайдет о разработке под мобильные устройства, мы будем пользоваться Titanium IDE, специальной\n платформе, созаднной&nbsp;<a href=\"http://appcelerator.com\" target=\"new\">Appcelerator Network</a>, которая является модернизированной версией Aptana IDE и имеет аналогичный интерфейс.</p><p>Сам я отдаю предпочтение продуктам компании&nbsp;<a href=\"http://jetbrains.com\" target=\"new\">JetBrains</a> и в частности &nbsp;<a href=\"http://www.jetbrains.com/webstorm/\" target=\"new\">WebStorm</a>, который в значительной степени ориентирован на веб-разработку на JavaScript, имеет хорошую поддержку современных языков,\n в том числе CoffeeScript и Jade, о которых говорилось выше, а также поддерживает систему встроенного докумнтирования\n JSDoc, которой будет посвящена отдельная глава туториала. WebStorm является коммерческим продуктом, однако вы можете\n воспользоваться 30-ти дневным пробным периодом. Так же на сайте доступны разные способы (и скидки) приобритения\n лицензии.</p><h4 id=\"browser\" class=\"title\">Браузер</h4><p>Браузер является неотъемлемым инструментом разработки в любом веб-проекте. Как я уже говорил, значительная доля написанного\n нами кода будет выполняться в контексте браузера, поэтому нам понадобятся средства для инспекции и отладки JS кода\n на стороне клиента. Сегодня все наиболее популярные браузеры имеют встроенную веб-консоль, что позволяет отслеживать\n вознкающие ошибки и исполнять произвольный код на стороне клиента. Вы можете использовать любой привычный и удобный\n для Вас браузер. Я в свою очередь все дальнейшие действия буду описать в рамках браузеров Google Chrome и Google\n Chromium.</p><h4>Установка и настройка окружения.</h4><h5 id=\"node\" class=\"title\">Node.JS и NPM</h5><p>Node.js доступен среди готовых пакетов репозиториев Ubuntu. Однако, к моменту написания данной главы пакет <b>nodejs</b>\n имеел версию 0.6.19, в то время как на официальном сайте доступны <a href='http://nodejs.org/download/' target='new')>архивы</a>\n с бинарными файлами версии 0.10.17.\n Я настоятельно рекомендую использовать последние версии Node.js, так как по мере развития данного проекта\n утверждается и стабилизируется его <a href='http://nodejs.org/api/' target='new'>API</a>\n. Также у Node.js существуют проблемы с утечкой памяти. Можно ожидать,\n что с новыми релизами эта, а также другие существующие проблемы будут частично или полностью устранены.</p><p>Настройку Node.js мы будем вести в \"кустарном\" режиме, храня все необходимые бинарные файлы в своей домашней директории.\n В зависимости от ваших предпочтений, вы можете использовать для размещения пакетов директорию<b> /opt</b>, либо же раскидать необходимые исполняемые файлы в директории<b> /usr/local/bin</b>. В этом случае вам необходимо будет позаботиться о правах создания, записи и чтения файлов из данных директорий.</p><div class=\"code\"><span>foo:~$ mkdir opt && cd ./opt</span><br/><span>foo:~/opt$ wget http://nodejs.org/dist/v0.10.17/node-v0.10.17-linux-x86.tar.gz</span><br/><span>foo:~/opt$ tar xzf node-v0.10.17-linux-x86.tar.gz</span><br/><span>foo:~/opt$ ln -s node-v0.10.17-linux-x86 node</span></div><p>Все обращения к Node.js будут вестись по ссылке с универсальным именем, так как в дальнейшем это упростит процесс перехода на\n новую версию интерпретатора - достаточно будет распаковать архив с очередной версией и заместить старую ссылку на новую.</p><p>Для удобства я советую добавить путь к исполняемым файлам Node.js в переменную<b> $PATH</b>, чтобы в дальнейшем упростить вызов\n интерпретатора или менеджера пакетов. В случае, если вы используете<b> bash</b>, вам следует выполнить следующую команду:</p><div class=\"code\"><span>bash:~$ echo \"PATH=$PATH:$HOME/opt/node/bin\" >> ~/.bashrc</span></div><p>С этого момента команды<b> node</b> и<b> npm</b> будут доступны для непосредственного вызова из терминала.</p><p>Еще немного о программе npm. Приложение<b> NPM</b> входящее в состав проекта Node.js предназначено для публикации и распространения пакетов, через&nbsp;<a href=\"https://npmjs.org/\" target=\"new\">реестр</a>. NPM позволяет установить в текущем проекте все необходимые локальные зависимости и использовать их в своем исходном\n коде в соотствии с технологией&nbsp;<a href=\"http://en.wikipedia.org/wiki/CommonJS\" target=\"new\">CommonJS</a> через метод<b> require</b>. Помимо этого NPM позволяет устанавливать зависимости глобально в рамках всей операционной системы. При этом, несмотря на\n фразу \"глобальная установка\", пакеты, установленные с опцией&nbsp;<b>-g</b>, не могут быть доступны в проектах через require. Данная опция, как правило, используются для распространения исполняемых файлов,\n которые могут быть включены в состав пакета, а также документации (в виде man-страниц). В некотором смысле\n это похоже на установку програмного обеспечения через систему пакетов, таких как APT. Более подробно о различиях\n между глобальной и локальной установкой пакетов NPM вы можете почитать в<a href=\"http://blog.nodejs.org/2011/03/23/npm-1-0-global-vs-local-installation/\" target=\"new\"> этом</a> блоге.</p><h5 id=\"mongo\" class=\"title\">MongoDB</h5><p>Для установки MongoDB на вашей рабочей машине вы можете либо воспользоваться существующими пакетами, доступными\n в APT репозитории Ubuntu, либо загрузить прекомпилированный архив и установить все вручную.</p><p>Установка приложения через apt-get\n не составляет проблем, поэтому ниже я опишу только процесс установки и\n минимальной настройки демона MongoDB в ручную. Архив с бинарными файлами доступен на странице&nbsp;<a href=\"http://www.mongodb.org/downloads\" target=\"new\">официального сайта</a> проекта. Выбрав нужную версию базы вы можете сохранить и распокавать архив на локальном диске.</p><div class=\"code\"><span>foo:~$ cd ~/opt</span><br/><span>foo:~/opt$ wget http://downloads.mongodb.org/linux/mongodb-linux-x86_64-2.4.6.tgz</span><br/><span>foo:~/opt$ tar zxf mongodb-linux-x86_64-2.4.6.tgz</span><br/><span>foo:~/opt$ ln -s mongodb-linux-x86_64-2.4.6 mongo</span></div><p>При создании базы необходимо создать директории, в которых будут храниться непосредственно файлы базы,\n а также файлы с log-данными и файл конфигурации.</p><div class=\"code\"><span>foo:~/opt$ cd mongo</span><br/><span>foo:~/opt/mongo$ mkdir data</span><br/><span>foo:~/opt/mongo$ touch mongo.cfg</span><br/></div><p>Файл<b> mongo.cfg</b> должен быть примерно следующего содержания:</p><div class=\"code light\"><span>dbpath=/home/vasya_pupkin/opt/mongo/data</span><br/><span>logpath=/home/vasya_pupkin/opt/mongo.log</span><br/><span>logappend=true</span><br/><span>journal=true</span><br/><span>verbose=true</span><br/><span>port=28017</span><br/><span>fork=true</span></div><p>С этого момента сервер базы данных может быть запущен:</p><div class=\"code\"><span>foo:~/opt/mongo$ bin/mongod --config=mongo.cfg</span><br/><span>about to fork child process, waiting until server is ready for connections.</span><br/><span>forked process: 5483</span><br/><span>all output going to: /home/vasya_pupkin/opt/mongo.log</span><br/><span>child process started successfully, parent exiting</span><br/><br/><span>foo:~/opt/mongo$ bin/mongo</span><br/><span>MongoDB shell version: 2.4.6</span><br/><span>connecting to: test</span><br/><span>Welcome to the MongoDB shell.</span><br/><span>For interactive help, type \"help\".</span><br/><span>For more comprehensive documentation, see</span><br/><span>http://docs.mongodb.org/</span><br/><span>Questions? Try the support group</span><br/><span>http://groups.google.com/group/mongodb-user</span><br/><span>></span></div><p>В том случае, если при запуске у вас возникли какие либо ошибки, подбробную информацию о них вы сможете найти\n в соответствующем log-файле<b> ~/opt/mongo.log</b>.</p><p>Дополнительную информацию об установке и настройке базы данных вы можете найти в официальном&nbsp;<a href=\"http://docs.mongodb.org/manual/installation/\" target=\"new\">мануале</a></p><div class=\"mark\"><h5>Примечание</h5><p>В данной главе я не рассматриваю вопросы защиты базы от несанкцонированного доступа. Если вы намерены\n разместить веб-приложение в Инернете, вам следует позаботиться о дополнительной настройке<b> mongod</b>, в том числе об аутентификации и привязке к конечному сетевому адресу.\n Более подробную информацию вы можете найти на сайте проекта в разделе, посвещенной&nbsp;<a href=\"http://docs.mongodb.org/manual/reference/configuration-options/\" target=\"new\">конфигурации сервера</a></p></div><p>Для быстрого доступа к исполняемым файлам сервера, также как и в случае с Node.js, я рекомендую добавить путь к директории<b> mongo/bin</b> в переменную окружения<b> $PATH</b>.</p></script>","<script data-profile='muon' data-pack='tutorial' type='text/muon-template' id='deep_spa_general_chapter_widget_template'><h3>Погружение SPA</h3></script>","<!-- tutorial:widget/chapter/general/basic_spa/basic_spa --><style data-pack='tutorial'>body.muon [data-pack='tutorial'][data-muon$='basic_spa_general_chapter_widget'] {\n  position: relative;\n}\nbody.muon [data-pack='tutorial'][data-muon$='basic_spa_general_chapter_widget'] ul {\n  padding: 0 20px;\n}\nbody.muon [data-pack='tutorial'][data-muon$='basic_spa_general_chapter_widget'] ul li {\n  text-align: justify;\n  list-style-type: square;\n}\n</style>"],

"translation": {"start_page_layout:first_chapter":"MuonJS является клиент-серверным фреймворком. Мы регламентируем&nbsp;правила построения как серверной, так и клиентской части разрабатываемого Вами веб-приложения. Обе составляющие&nbsp;фреймворка пересекаются и имеют ряд зависимостей относительно друг друга. Но в большей степени использование&nbsp;обоих частей бибилотеки направленно на поддержание идеи построения развитых одностраничных приложений (<a href='//en.wikipedia.org/wiki/Single-page_application'>Single Page Application</a>).","start_page_layout:second_chapter":"Во многих случаях вы можете использовать каждую из частей независимо друг от друга.&nbsp;Для полной поддержки всех возможностей, предоставляемых библиотекойspan.highlight  MuonJSClient&nbsp;, в сочетании&nbsp;с произвольной серверной частью, Ваш back-end должен удовлетворять рядом требований, о которых вы можете&nbsp;прочитать в соответствующем <a data-route='client/chapter/'>разделе</a>&nbsp;данного туториала.","general_summary_widget:p_pre":"Данный раздел посвещен общим вопросам построения одностраничных веб-приложений.<br>В первой части раздела вы найдете информацию о том, как на базе библиотеки развернуть, настроить и запустить приложение. Будет приведен общий перечень компонент приложения, а также описана струтура файловой системы проекта.<br><br>Остальная часть раздела посвещена вопросу особенностей построения native-like веб-приложений, сравнение структуры SAP-приложения с классическими сайтами со страницами, генерируемыми на стороне сервера. Будет дан обзор существующим парадигмам и технологиям программирования в сфере веба.<br><br>В самом начале данного раздела будет создано небольшое тестовое приложение, на напримере которого в последней главе раздела будут показаны основные принципы функционирования SAP.<br>Более подробное описание работы библиотеки вы можете найти в соответствующих разделах, посвещенных <a data-route='server'>серверной</a> и <a data-route='client'>клиентской</a> частям фреймворка, а также в <a data-route='/doc'>документации</a>","general_summary_widget:h_index":"Содержание"},

"dependencies": {"js":["!function(){var q=null;window.PR_SHOULD_USE_CONTINUATION=!0;\n(function(){function S(a){function d(e){var b=e.charCodeAt(0);if(b!==92)return b;var a=e.charAt(1);return(b=r[a])?b:\"0\"<=a&&a<=\"7\"?parseInt(e.substring(1),8):a===\"u\"||a===\"x\"?parseInt(e.substring(2),16):e.charCodeAt(1)}function g(e){if(e<32)return(e<16?\"\\\\x0\":\"\\\\x\")+e.toString(16);e=String.fromCharCode(e);return e===\"\\\\\"||e===\"-\"||e===\"]\"||e===\"^\"?\"\\\\\"+e:e}function b(e){var b=e.substring(1,e.length-1).match(/\\\\u[\\dA-Fa-f]{4}|\\\\x[\\dA-Fa-f]{2}|\\\\[0-3][0-7]{0,2}|\\\\[0-7]{1,2}|\\\\[\\S\\s]|[^\\\\]/g),e=[],a=\nb[0]===\"^\",c=[\"[\"];a&&c.push(\"^\");for(var a=a?1:0,f=b.length;a<f;++a){var h=b[a];if(/\\\\[bdsw]/i.test(h))c.push(h);else{var h=d(h),l;a+2<f&&\"-\"===b[a+1]?(l=d(b[a+2]),a+=2):l=h;e.push([h,l]);l<65||h>122||(l<65||h>90||e.push([Math.max(65,h)|32,Math.min(l,90)|32]),l<97||h>122||e.push([Math.max(97,h)&-33,Math.min(l,122)&-33]))}}e.sort(function(e,a){return e[0]-a[0]||a[1]-e[1]});b=[];f=[];for(a=0;a<e.length;++a)h=e[a],h[0]<=f[1]+1?f[1]=Math.max(f[1],h[1]):b.push(f=h);for(a=0;a<b.length;++a)h=b[a],c.push(g(h[0])),\nh[1]>h[0]&&(h[1]+1>h[0]&&c.push(\"-\"),c.push(g(h[1])));c.push(\"]\");return c.join(\"\")}function s(e){for(var a=e.source.match(/\\[(?:[^\\\\\\]]|\\\\[\\S\\s])*]|\\\\u[\\dA-Fa-f]{4}|\\\\x[\\dA-Fa-f]{2}|\\\\\\d+|\\\\[^\\dux]|\\(\\?[!:=]|[()^]|[^()[\\\\^]+/g),c=a.length,d=[],f=0,h=0;f<c;++f){var l=a[f];l===\"(\"?++h:\"\\\\\"===l.charAt(0)&&(l=+l.substring(1))&&(l<=h?d[l]=-1:a[f]=g(l))}for(f=1;f<d.length;++f)-1===d[f]&&(d[f]=++x);for(h=f=0;f<c;++f)l=a[f],l===\"(\"?(++h,d[h]||(a[f]=\"(?:\")):\"\\\\\"===l.charAt(0)&&(l=+l.substring(1))&&l<=h&&\n(a[f]=\"\\\\\"+d[l]);for(f=0;f<c;++f)\"^\"===a[f]&&\"^\"!==a[f+1]&&(a[f]=\"\");if(e.ignoreCase&&m)for(f=0;f<c;++f)l=a[f],e=l.charAt(0),l.length>=2&&e===\"[\"?a[f]=b(l):e!==\"\\\\\"&&(a[f]=l.replace(/[A-Za-z]/g,function(a){a=a.charCodeAt(0);return\"[\"+String.fromCharCode(a&-33,a|32)+\"]\"}));return a.join(\"\")}for(var x=0,m=!1,j=!1,k=0,c=a.length;k<c;++k){var i=a[k];if(i.ignoreCase)j=!0;else if(/[a-z]/i.test(i.source.replace(/\\\\u[\\da-f]{4}|\\\\x[\\da-f]{2}|\\\\[^UXux]/gi,\"\"))){m=!0;j=!1;break}}for(var r={b:8,t:9,n:10,v:11,\nf:12,r:13},n=[],k=0,c=a.length;k<c;++k){i=a[k];if(i.global||i.multiline)throw Error(\"\"+i);n.push(\"(?:\"+s(i)+\")\")}return RegExp(n.join(\"|\"),j?\"gi\":\"g\")}function T(a,d){function g(a){var c=a.nodeType;if(c==1){if(!b.test(a.className)){for(c=a.firstChild;c;c=c.nextSibling)g(c);c=a.nodeName.toLowerCase();if(\"br\"===c||\"li\"===c)s[j]=\"\\n\",m[j<<1]=x++,m[j++<<1|1]=a}}else if(c==3||c==4)c=a.nodeValue,c.length&&(c=d?c.replace(/\\r\\n?/g,\"\\n\"):c.replace(/[\\t\\n\\r ]+/g,\" \"),s[j]=c,m[j<<1]=x,x+=c.length,m[j++<<1|1]=\na)}var b=/(?:^|\\s)nocode(?:\\s|$)/,s=[],x=0,m=[],j=0;g(a);return{a:s.join(\"\").replace(/\\n$/,\"\"),d:m}}function H(a,d,g,b){d&&(a={a:d,e:a},g(a),b.push.apply(b,a.g))}function U(a){for(var d=void 0,g=a.firstChild;g;g=g.nextSibling)var b=g.nodeType,d=b===1?d?a:g:b===3?V.test(g.nodeValue)?a:d:d;return d===a?void 0:d}function C(a,d){function g(a){for(var j=a.e,k=[j,\"pln\"],c=0,i=a.a.match(s)||[],r={},n=0,e=i.length;n<e;++n){var z=i[n],w=r[z],t=void 0,f;if(typeof w===\"string\")f=!1;else{var h=b[z.charAt(0)];\nif(h)t=z.match(h[1]),w=h[0];else{for(f=0;f<x;++f)if(h=d[f],t=z.match(h[1])){w=h[0];break}t||(w=\"pln\")}if((f=w.length>=5&&\"lang-\"===w.substring(0,5))&&!(t&&typeof t[1]===\"string\"))f=!1,w=\"src\";f||(r[z]=w)}h=c;c+=z.length;if(f){f=t[1];var l=z.indexOf(f),B=l+f.length;t[2]&&(B=z.length-t[2].length,l=B-f.length);w=w.substring(5);H(j+h,z.substring(0,l),g,k);H(j+h+l,f,I(w,f),k);H(j+h+B,z.substring(B),g,k)}else k.push(j+h,w)}a.g=k}var b={},s;(function(){for(var g=a.concat(d),j=[],k={},c=0,i=g.length;c<i;++c){var r=\ng[c],n=r[3];if(n)for(var e=n.length;--e>=0;)b[n.charAt(e)]=r;r=r[1];n=\"\"+r;k.hasOwnProperty(n)||(j.push(r),k[n]=q)}j.push(/[\\S\\s]/);s=S(j)})();var x=d.length;return g}function v(a){var d=[],g=[];a.tripleQuotedStrings?d.push([\"str\",/^(?:'''(?:[^'\\\\]|\\\\[\\S\\s]|''?(?=[^']))*(?:'''|$)|\"\"\"(?:[^\"\\\\]|\\\\[\\S\\s]|\"\"?(?=[^\"]))*(?:\"\"\"|$)|'(?:[^'\\\\]|\\\\[\\S\\s])*(?:'|$)|\"(?:[^\"\\\\]|\\\\[\\S\\s])*(?:\"|$))/,q,\"'\\\"\"]):a.multiLineStrings?d.push([\"str\",/^(?:'(?:[^'\\\\]|\\\\[\\S\\s])*(?:'|$)|\"(?:[^\"\\\\]|\\\\[\\S\\s])*(?:\"|$)|`(?:[^\\\\`]|\\\\[\\S\\s])*(?:`|$))/,\nq,\"'\\\"`\"]):d.push([\"str\",/^(?:'(?:[^\\n\\r'\\\\]|\\\\.)*(?:'|$)|\"(?:[^\\n\\r\"\\\\]|\\\\.)*(?:\"|$))/,q,\"\\\"'\"]);a.verbatimStrings&&g.push([\"str\",/^@\"(?:[^\"]|\"\")*(?:\"|$)/,q]);var b=a.hashComments;b&&(a.cStyleComments?(b>1?d.push([\"com\",/^#(?:##(?:[^#]|#(?!##))*(?:###|$)|.*)/,q,\"#\"]):d.push([\"com\",/^#(?:(?:define|e(?:l|nd)if|else|error|ifn?def|include|line|pragma|undef|warning)\\b|[^\\n\\r]*)/,q,\"#\"]),g.push([\"str\",/^<(?:(?:(?:\\.\\.\\/)*|\\/?)(?:[\\w-]+(?:\\/[\\w-]+)+)?[\\w-]+\\.h(?:h|pp|\\+\\+)?|[a-z]\\w*)>/,q])):d.push([\"com\",\n/^#[^\\n\\r]*/,q,\"#\"]));a.cStyleComments&&(g.push([\"com\",/^\\/\\/[^\\n\\r]*/,q]),g.push([\"com\",/^\\/\\*[\\S\\s]*?(?:\\*\\/|$)/,q]));if(b=a.regexLiterals){var s=(b=b>1?\"\":\"\\n\\r\")?\".\":\"[\\\\S\\\\s]\";g.push([\"lang-regex\",RegExp(\"^(?:^^\\\\.?|[+-]|[!=]=?=?|\\\\#|%=?|&&?=?|\\\\(|\\\\*=?|[+\\\\-]=|->|\\\\/=?|::?|<<?=?|>>?>?=?|,|;|\\\\?|@|\\\\[|~|{|\\\\^\\\\^?=?|\\\\|\\\\|?=?|break|case|continue|delete|do|else|finally|instanceof|return|throw|try|typeof)\\\\s*(\"+(\"/(?=[^/*\"+b+\"])(?:[^/\\\\x5B\\\\x5C\"+b+\"]|\\\\x5C\"+s+\"|\\\\x5B(?:[^\\\\x5C\\\\x5D\"+b+\"]|\\\\x5C\"+\ns+\")*(?:\\\\x5D|$))+/\")+\")\")])}(b=a.types)&&g.push([\"typ\",b]);b=(\"\"+a.keywords).replace(/^ | $/g,\"\");b.length&&g.push([\"kwd\",RegExp(\"^(?:\"+b.replace(/[\\s,]+/g,\"|\")+\")\\\\b\"),q]);d.push([\"pln\",/^\\s+/,q,\" \\r\\n\\t\\u00a0\"]);b=\"^.[^\\\\s\\\\w.$@'\\\"`/\\\\\\\\]*\";a.regexLiterals&&(b+=\"(?!s*/)\");g.push([\"lit\",/^@[$_a-z][\\w$@]*/i,q],[\"typ\",/^(?:[@_]?[A-Z]+[a-z][\\w$@]*|\\w+_t\\b)/,q],[\"pln\",/^[$_a-z][\\w$@]*/i,q],[\"lit\",/^(?:0x[\\da-f]+|(?:\\d(?:_\\d+)*\\d*(?:\\.\\d*)?|\\.\\d\\+)(?:e[+-]?\\d+)?)[a-z]*/i,q,\"0123456789\"],[\"pln\",/^\\\\[\\S\\s]?/,\nq],[\"pun\",RegExp(b),q]);return C(d,g)}function J(a,d,g){function b(a){var c=a.nodeType;if(c==1&&!x.test(a.className))if(\"br\"===a.nodeName)s(a),a.parentNode&&a.parentNode.removeChild(a);else for(a=a.firstChild;a;a=a.nextSibling)b(a);else if((c==3||c==4)&&g){var d=a.nodeValue,i=d.match(m);if(i)c=d.substring(0,i.index),a.nodeValue=c,(d=d.substring(i.index+i[0].length))&&a.parentNode.insertBefore(j.createTextNode(d),a.nextSibling),s(a),c||a.parentNode.removeChild(a)}}function s(a){function b(a,c){var d=\nc?a.cloneNode(!1):a,e=a.parentNode;if(e){var e=b(e,1),g=a.nextSibling;e.appendChild(d);for(var i=g;i;i=g)g=i.nextSibling,e.appendChild(i)}return d}for(;!a.nextSibling;)if(a=a.parentNode,!a)return;for(var a=b(a.nextSibling,0),d;(d=a.parentNode)&&d.nodeType===1;)a=d;c.push(a)}for(var x=/(?:^|\\s)nocode(?:\\s|$)/,m=/\\r\\n?|\\n/,j=a.ownerDocument,k=j.createElement(\"li\");a.firstChild;)k.appendChild(a.firstChild);for(var c=[k],i=0;i<c.length;++i)b(c[i]);d===(d|0)&&c[0].setAttribute(\"value\",d);var r=j.createElement(\"ol\");\nr.className=\"linenums\";for(var d=Math.max(0,d-1|0)||0,i=0,n=c.length;i<n;++i)k=c[i],k.className=\"L\"+(i+d)%10,k.firstChild||k.appendChild(j.createTextNode(\"\\u00a0\")),r.appendChild(k);a.appendChild(r)}function p(a,d){for(var g=d.length;--g>=0;){var b=d[g];F.hasOwnProperty(b)?D.console&&console.warn(\"cannot override language handler %s\",b):F[b]=a}}function I(a,d){if(!a||!F.hasOwnProperty(a))a=/^\\s*</.test(d)?\"default-markup\":\"default-code\";return F[a]}function K(a){var d=a.h;try{var g=T(a.c,a.i),b=g.a;\na.a=b;a.d=g.d;a.e=0;I(d,b)(a);var s=/\\bMSIE\\s(\\d+)/.exec(navigator.userAgent),s=s&&+s[1]<=8,d=/\\n/g,x=a.a,m=x.length,g=0,j=a.d,k=j.length,b=0,c=a.g,i=c.length,r=0;c[i]=m;var n,e;for(e=n=0;e<i;)c[e]!==c[e+2]?(c[n++]=c[e++],c[n++]=c[e++]):e+=2;i=n;for(e=n=0;e<i;){for(var p=c[e],w=c[e+1],t=e+2;t+2<=i&&c[t+1]===w;)t+=2;c[n++]=p;c[n++]=w;e=t}c.length=n;var f=a.c,h;if(f)h=f.style.display,f.style.display=\"none\";try{for(;b<k;){var l=j[b+2]||m,B=c[r+2]||m,t=Math.min(l,B),A=j[b+1],G;if(A.nodeType!==1&&(G=x.substring(g,\nt))){s&&(G=G.replace(d,\"\\r\"));A.nodeValue=G;var L=A.ownerDocument,o=L.createElement(\"span\");o.className=c[r+1];var v=A.parentNode;v.replaceChild(o,A);o.appendChild(A);g<l&&(j[b+1]=A=L.createTextNode(x.substring(t,l)),v.insertBefore(A,o.nextSibling))}g=t;g>=l&&(b+=2);g>=B&&(r+=2)}}finally{if(f)f.style.display=h}}catch(u){D.console&&console.log(u&&u.stack||u)}}var D=window,y=[\"break,continue,do,else,for,if,return,while\"],E=[[y,\"auto,case,char,const,default,double,enum,extern,float,goto,inline,int,long,register,short,signed,sizeof,static,struct,switch,typedef,union,unsigned,void,volatile\"],\n\"catch,class,delete,false,import,new,operator,private,protected,public,this,throw,true,try,typeof\"],M=[E,\"alignof,align_union,asm,axiom,bool,concept,concept_map,const_cast,constexpr,decltype,delegate,dynamic_cast,explicit,export,friend,generic,late_check,mutable,namespace,nullptr,property,reinterpret_cast,static_assert,static_cast,template,typeid,typename,using,virtual,where\"],N=[E,\"abstract,assert,boolean,byte,extends,final,finally,implements,import,instanceof,interface,null,native,package,strictfp,super,synchronized,throws,transient\"],\nO=[N,\"as,base,by,checked,decimal,delegate,descending,dynamic,event,fixed,foreach,from,group,implicit,in,internal,into,is,let,lock,object,out,override,orderby,params,partial,readonly,ref,sbyte,sealed,stackalloc,string,select,uint,ulong,unchecked,unsafe,ushort,var,virtual,where\"],E=[E,\"debugger,eval,export,function,get,null,set,undefined,var,with,Infinity,NaN\"],P=[y,\"and,as,assert,class,def,del,elif,except,exec,finally,from,global,import,in,is,lambda,nonlocal,not,or,pass,print,raise,try,with,yield,False,True,None\"],\nQ=[y,\"alias,and,begin,case,class,def,defined,elsif,end,ensure,false,in,module,next,nil,not,or,redo,rescue,retry,self,super,then,true,undef,unless,until,when,yield,BEGIN,END\"],W=[y,\"as,assert,const,copy,drop,enum,extern,fail,false,fn,impl,let,log,loop,match,mod,move,mut,priv,pub,pure,ref,self,static,struct,true,trait,type,unsafe,use\"],y=[y,\"case,done,elif,esac,eval,fi,function,in,local,set,then,until\"],R=/^(DIR|FILE|vector|(de|priority_)?queue|list|stack|(const_)?iterator|(multi)?(set|map)|bitset|u?(int|float)\\d*)\\b/,\nV=/\\S/,X=v({keywords:[M,O,E,\"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END\",P,Q,y],hashComments:!0,cStyleComments:!0,multiLineStrings:!0,regexLiterals:!0}),F={};p(X,[\"default-code\"]);p(C([],[[\"pln\",/^[^<?]+/],[\"dec\",/^<!\\w[^>]*(?:>|$)/],[\"com\",/^<\\!--[\\S\\s]*?(?:--\\>|$)/],[\"lang-\",/^<\\?([\\S\\s]+?)(?:\\?>|$)/],[\"lang-\",/^<%([\\S\\s]+?)(?:%>|$)/],[\"pun\",/^(?:<[%?]|[%?]>)/],[\"lang-\",\n/^<xmp\\b[^>]*>([\\S\\s]+?)<\\/xmp\\b[^>]*>/i],[\"lang-js\",/^<script\\b[^>]*>([\\S\\s]*?)(<\\/script\\b[^>]*>)/i],[\"lang-css\",/^<style\\b[^>]*>([\\S\\s]*?)(<\\/style\\b[^>]*>)/i],[\"lang-in.tag\",/^(<\\/?[a-z][^<>]*>)/i]]),[\"default-markup\",\"htm\",\"html\",\"mxml\",\"xhtml\",\"xml\",\"xsl\"]);p(C([[\"pln\",/^\\s+/,q,\" \\t\\r\\n\"],[\"atv\",/^(?:\"[^\"]*\"?|'[^']*'?)/,q,\"\\\"'\"]],[[\"tag\",/^^<\\/?[a-z](?:[\\w-.:]*\\w)?|\\/?>$/i],[\"atn\",/^(?!style[\\s=]|on)[a-z](?:[\\w:-]*\\w)?/i],[\"lang-uq.val\",/^=\\s*([^\\s\"'>]*(?:[^\\s\"'/>]|\\/(?=\\s)))/],[\"pun\",/^[/<->]+/],\n[\"lang-js\",/^on\\w+\\s*=\\s*\"([^\"]+)\"/i],[\"lang-js\",/^on\\w+\\s*=\\s*'([^']+)'/i],[\"lang-js\",/^on\\w+\\s*=\\s*([^\\s\"'>]+)/i],[\"lang-css\",/^style\\s*=\\s*\"([^\"]+)\"/i],[\"lang-css\",/^style\\s*=\\s*'([^']+)'/i],[\"lang-css\",/^style\\s*=\\s*([^\\s\"'>]+)/i]]),[\"in.tag\"]);p(C([],[[\"atv\",/^[\\S\\s]+/]]),[\"uq.val\"]);p(v({keywords:M,hashComments:!0,cStyleComments:!0,types:R}),[\"c\",\"cc\",\"cpp\",\"cxx\",\"cyc\",\"m\"]);p(v({keywords:\"null,true,false\"}),[\"json\"]);p(v({keywords:O,hashComments:!0,cStyleComments:!0,verbatimStrings:!0,types:R}),\n[\"cs\"]);p(v({keywords:N,cStyleComments:!0}),[\"java\"]);p(v({keywords:y,hashComments:!0,multiLineStrings:!0}),[\"bash\",\"bsh\",\"csh\",\"sh\"]);p(v({keywords:P,hashComments:!0,multiLineStrings:!0,tripleQuotedStrings:!0}),[\"cv\",\"py\",\"python\"]);p(v({keywords:\"caller,delete,die,do,dump,elsif,eval,exit,foreach,for,goto,if,import,last,local,my,next,no,our,print,package,redo,require,sub,undef,unless,until,use,wantarray,while,BEGIN,END\",hashComments:!0,multiLineStrings:!0,regexLiterals:2}),[\"perl\",\"pl\",\"pm\"]);p(v({keywords:Q,\nhashComments:!0,multiLineStrings:!0,regexLiterals:!0}),[\"rb\",\"ruby\"]);p(v({keywords:E,cStyleComments:!0,regexLiterals:!0}),[\"javascript\",\"js\"]);p(v({keywords:\"all,and,by,catch,class,else,extends,false,finally,for,if,in,is,isnt,loop,new,no,not,null,of,off,on,or,return,super,then,throw,true,try,unless,until,when,while,yes\",hashComments:3,cStyleComments:!0,multilineStrings:!0,tripleQuotedStrings:!0,regexLiterals:!0}),[\"coffee\"]);p(v({keywords:W,cStyleComments:!0,multilineStrings:!0}),[\"rc\",\"rs\",\"rust\"]);\np(C([],[[\"str\",/^[\\S\\s]+/]]),[\"regex\"]);var Y=D.PR={createSimpleLexer:C,registerLangHandler:p,sourceDecorator:v,PR_ATTRIB_NAME:\"atn\",PR_ATTRIB_VALUE:\"atv\",PR_COMMENT:\"com\",PR_DECLARATION:\"dec\",PR_KEYWORD:\"kwd\",PR_LITERAL:\"lit\",PR_NOCODE:\"nocode\",PR_PLAIN:\"pln\",PR_PUNCTUATION:\"pun\",PR_SOURCE:\"src\",PR_STRING:\"str\",PR_TAG:\"tag\",PR_TYPE:\"typ\",prettyPrintOne:D.prettyPrintOne=function(a,d,g){var b=document.createElement(\"div\");b.innerHTML=\"<pre>\"+a+\"</pre>\";b=b.firstChild;g&&J(b,g,!0);K({h:d,j:g,c:b,i:1});\nreturn b.innerHTML},prettyPrint:D.prettyPrint=function(a,d){function g(){for(var b=D.PR_SHOULD_USE_CONTINUATION?c.now()+250:Infinity;i<p.length&&c.now()<b;i++){for(var d=p[i],j=h,k=d;k=k.previousSibling;){var m=k.nodeType,o=(m===7||m===8)&&k.nodeValue;if(o?!/^\\??prettify\\b/.test(o):m!==3||/\\S/.test(k.nodeValue))break;if(o){j={};o.replace(/\\b(\\w+)=([\\w%+\\-.:]+)/g,function(a,b,c){j[b]=c});break}}k=d.className;if((j!==h||e.test(k))&&!v.test(k)){m=!1;for(o=d.parentNode;o;o=o.parentNode)if(f.test(o.tagName)&&\no.className&&e.test(o.className)){m=!0;break}if(!m){d.className+=\" prettyprinted\";m=j.lang;if(!m){var m=k.match(n),y;if(!m&&(y=U(d))&&t.test(y.tagName))m=y.className.match(n);m&&(m=m[1])}if(w.test(d.tagName))o=1;else var o=d.currentStyle,u=s.defaultView,o=(o=o?o.whiteSpace:u&&u.getComputedStyle?u.getComputedStyle(d,q).getPropertyValue(\"white-space\"):0)&&\"pre\"===o.substring(0,3);u=j.linenums;if(!(u=u===\"true\"||+u))u=(u=k.match(/\\blinenums\\b(?::(\\d+))?/))?u[1]&&u[1].length?+u[1]:!0:!1;u&&J(d,u,o);r=\n{h:m,c:d,j:u,i:o};K(r)}}}i<p.length?setTimeout(g,250):\"function\"===typeof a&&a()}for(var b=d||document.body,s=b.ownerDocument||document,b=[b.getElementsByTagName(\"pre\"),b.getElementsByTagName(\"code\"),b.getElementsByTagName(\"xmp\")],p=[],m=0;m<b.length;++m)for(var j=0,k=b[m].length;j<k;++j)p.push(b[m][j]);var b=q,c=Date;c.now||(c={now:function(){return+new Date}});var i=0,r,n=/\\blang(?:uage)?-([\\w.]+)(?!\\S)/,e=/\\bprettyprint\\b/,v=/\\bprettyprinted\\b/,w=/pre|xmp/i,t=/^code$/i,f=/^(?:pre|code|xmp)$/i,\nh={};g()}};typeof define===\"function\"&&define.amd&&define(\"google-code-prettify\",[],function(){return Y})})();}()\n"],"css":["","[data-pack='tutorial'] .pln {\n  color: #000000;\n}\n@media screen {\n  [data-pack='tutorial'] .str {\n    color: #008800;\n  }\n  [data-pack='tutorial'] .kwd {\n    color: #000088;\n  }\n  [data-pack='tutorial'] .com {\n    color: #880000;\n  }\n  [data-pack='tutorial'] .typ {\n    color: #660066;\n  }\n  [data-pack='tutorial'] .lit {\n    color: #006666;\n  }\n  [data-pack='tutorial'] .pun,\n  [data-pack='tutorial'] .opn,\n  [data-pack='tutorial'] .clo {\n    color: #666600;\n  }\n  [data-pack='tutorial'] .tag {\n    color: #000088;\n  }\n  [data-pack='tutorial'] .atn {\n    color: #660066;\n  }\n  [data-pack='tutorial'] .atv {\n    color: #008800;\n  }\n  [data-pack='tutorial'] .dec,\n  [data-pack='tutorial'] .var {\n    color: #660066;\n  }\n  [data-pack='tutorial'] .fun {\n    color: #ff0000;\n  }\n}\n@media print, projection {\n  [data-pack='tutorial'] .str {\n    color: #006600;\n  }\n  [data-pack='tutorial'] .kwd {\n    color: #006;\n    font-weight: bold;\n  }\n  [data-pack='tutorial'] .com {\n    color: #600;\n    font-style: italic;\n  }\n  [data-pack='tutorial'] .typ {\n    color: #404;\n    font-weight: bold;\n  }\n  [data-pack='tutorial'] .lit {\n    color: #004444;\n  }\n  [data-pack='tutorial'] .pun,\n  [data-pack='tutorial'] .opn,\n  [data-pack='tutorial'] .clo {\n    color: #444400;\n  }\n  [data-pack='tutorial'] .tag {\n    color: #006;\n    font-weight: bold;\n  }\n  [data-pack='tutorial'] .atn {\n    color: #440044;\n  }\n  [data-pack='tutorial'] .atv {\n    color: #006600;\n  }\n}\n[data-pack='tutorial'] pre.prettyprint {\n  padding: 2px;\n  border: 1px solid #888888;\n}\n[data-pack='tutorial'] ol.linenums {\n  margin-top: 0;\n  margin-bottom: 0;\n}\n[data-pack='tutorial'] li.L0,\n[data-pack='tutorial'] li.L1,\n[data-pack='tutorial'] li.L2,\n[data-pack='tutorial'] li.L3,\n[data-pack='tutorial'] li.L5,\n[data-pack='tutorial'] li.L6,\n[data-pack='tutorial'] li.L7,\n[data-pack='tutorial'] li.L8 {\n  list-style-type: none;\n}\n[data-pack='tutorial'] li.L1,\n[data-pack='tutorial'] li.L3,\n[data-pack='tutorial'] li.L5,\n[data-pack='tutorial'] li.L7,\n[data-pack='tutorial'] li.L9 {\n  background: #eeeeee;\n}\n","[data-pack='tutorial'] pre.prettyprint {\n  display: block;\n  background-color: #eee;\n  border: none;\n  border-left: 5px solid #888;\n  font-family: Courier New, Courier, monospace;\n}\n","","[data-pack='tutorial'] span.crossline {\n  text-decoration: line-through;\n}\n"]},

"cfg": {},


};